vars(Day, Status),
covariates = list(by), # covariates expects a list
covariate_name_dict = covariate_names)
}) %>%
forest_plot(factor_labeller = covariate_names,
endpoint_labeller = c(time="OS"),
orderer = ~order(HR),
labels_displayed = c("endpoint", "factor", "n"),
ggtheme = ggplot2::theme_bw(base_size = 12))
map(vars(Treatment, sex, #Family,
#`coat color`,
Pigment_Dispersion, `Did Not Dilate`, AML, GCT,
Hard_ACA, Hard_Ad, HCC, Hist_Sarc, LSA_PreT,
`LSA_B-cell`,Mamm_ACA,OSA,`Pulmonary Adenocarcinoma`,
Pituitary_Ad,STS,Thyroid,
`Number of Tumors`), function(by)
{
analyse_multivariate(df,
vars(Day, Status),
covariates = list(by), # covariates expects a list
covariate_name_dict = covariate_names)
}) %>%
forest_plot(factor_labeller = covariate_names,
endpoint_labeller = c(time="OS"),
orderer = ~order(HR),
labels_displayed = c("endpoint", "factor", "n"),
ggtheme = ggplot2::theme_bw(base_size = 12))
map(vars(Family), function(by)
{
analyse_multivariate(df,
vars(Day, Status),
covariates = list(by), # covariates expects a list
covariate_name_dict = covariate_names)
}) %>%
forest_plot(factor_labeller = covariate_names,
endpoint_labeller = c(time="OS"),
orderer = ~order(HR),
labels_displayed = c("endpoint", "factor", "n"),
ggtheme = ggplot2::theme_bw(base_size = 12))
data %>%
mutate(sex=rename_factor(sex, `M` = "male", `F` = "female")) %>%
analyse_multivariate(vars(Day, Status),
covariates = vars(Treatment, `Number of Tumors`, sex),
covariate_name_dict = covariate_names) ->
result
print(result)
forest_plot(result,
factor_labeller = covariate_names,
endpoint_labeller = c(time="OS"),
orderer = ~order(HR),
labels_displayed = c("endpoint", "factor", "n"),
ggtheme = ggplot2::theme_bw(base_size = 10),
relative_widths = c(1, 1.5, 1),
HR_x_breaks = c(0.25, 0.5, 0.75, 1, 1.5, 2))
data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_DND")
library(gapminder)
allplot <- data %>% dplyr::group_by(family, Overall)%>% dplyr::summarise(cat_score = mean(cat_score)) %>%
#arrange(desc(cat_score)) %>%
#mutate(family = fct_reorder(family, families)) %>%
ggplot(aes(x = family, y = Overall, size = cat_score, color = family)) +
geom_point(alpha=0.5) +
geom_text(aes(label = round(cat_score, digits = 1)), size = 3) +
scale_radius(range = c(3, 23))+
theme_bw() +
theme(axis.title.y=element_blank())+
theme(axis.title.x=element_blank())+
guides(color = FALSE)
sexplot <- data %>% dplyr::group_by(family, Sex)%>% dplyr::summarise(cat_score = mean(cat_score)) %>%
ggplot(aes(x = family, y = Sex, size = cat_score, color = family)) +
geom_point(alpha=0.5) +
geom_text(aes(label = round(cat_score, digits = 1)), size = 3) +
scale_radius(range = c(3, 23))+
theme_bw() +
theme(axis.title.y=element_blank())+
theme(axis.title.x=element_blank())+
guides(color = FALSE)
radplot <- data %>% dplyr::group_by(family, groups)%>% dplyr::summarise(cat_score = mean(cat_score)) %>%
ggplot(aes(x = family, y = groups, size = cat_score, color = family)) +
geom_point(alpha=0.5) +
geom_text(aes(label = round(cat_score, digits = 1)), size = 3) +
scale_radius(range = c(3, 23))+
theme_bw() +
theme(axis.title.y=element_blank())+
theme(axis.title.x=element_blank())+
guides(color = FALSE)
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_Harderian_DND")
data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/2023 Cataract Data.xlsx", sheet = "DND")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_Harderian_DND")
data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/2023 Cataract Data.xlsx", sheet = "DND")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_Harderian_DND")
data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/2023 Cataract Data.xlsx", sheet = "DND")
data <- data %>%  mutate(Family = as.character(family),
BCS = as.ordered(BCS),
Sex = sex,
Treatment = relevel(as.factor(groups), ref = "Unirradiated"),
`Number of Tumors` = relevel(as.factor(`Number of Tumors`), ref = "No tumors"))
data <- data %>%  mutate(Family = as.numeric(families),
BCS = as.ordered(BCS),
Sex = sex,
Treatment = relevel(as.factor(groups), ref = "Unirradiated"),
`Number of Tumors` = relevel(as.factor(`Number of Tumors`), ref = "No tumors"))
Status = data$`Cat 2.0`
Day = data$`Cat 2.0 day`
coxfit <- coxph(Surv(Day, Status) ~ Treatment + Sex, data = data)
summary(coxfit)
plot_cox <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_cox
coxfit <- coxph(Surv(Day, Status) ~ `Number of Tumors`, data = data)
summary(coxfit)
plot_tumors <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_tumors
data <- data %>%  mutate(Family = as.numeric(family),
BCS = as.ordered(BCS),
Sex = Sex,
Treatment = relevel(as.factor(groups), ref = "Unirradiated"),
`Number of Tumors` = relevel(as.factor(`Number of Tumors`), ref = "No tumors"))
Status = data$`Cat 2.0`
Day = data$`Cat 2.0 day`
covariate_names <- c(Treatment = relevel(as.factor(data$groups), ref = "Unirradiated"),
sex=data$Sex,
`sex:female`="F",
Family = as.numeric(data$family),
CoatColor=data$"coat color",
BCS = as.ordered(data$BCS),
#Amyloidosis=data$Amyloidosis,
AML=data$AML,
GCT=data$GCT,
Hard_ACA=data$Hard_ACA,
Hard_Ad=data$Hard_Ad,
HCC=data$HCC,
Hist_Sarc=data$Hist_Sarc,
LSA_PreT=data$LSA_PreT,
`LSA_B-cell`=data$`LSA_B-cell`,
Mamm_ACA=data$Mamm_ACA,
OSA=data$OSA,
Pulmonary_ACA = data$`Pulmonary Adenocarcinoma`,
Pituitary_Ad=data$Pituitary_Ad,
STS=data$STS,
Thyroid =data$Thyroid,
Pigment_Dispersion = data$Pigment_Dispersion,
Did_not_dilate = data$`Did Not Dilate`)
df <- data %>% mutate(sex=rename_factor(sex, `M` = "male", `F` = "female"))
map(vars(Treatment, sex, #Family,
#`coat color`,
Pigment_Dispersion, `Did Not Dilate`, AML, GCT,
Hard_ACA, Hard_Ad, HCC, Hist_Sarc, LSA_PreT,
`LSA_B-cell`,Mamm_ACA,OSA,`Pulmonary Adenocarcinoma`,
Pituitary_Ad,STS,Thyroid,
`Number of Tumors`), function(by)
{
analyse_multivariate(df,
vars(Day, Status),
covariates = list(by), # covariates expects a list
covariate_name_dict = covariate_names)
}) %>%
forest_plot(factor_labeller = covariate_names,
endpoint_labeller = c(time="OS"),
orderer = ~order(HR),
labels_displayed = c("endpoint", "factor", "n"),
ggtheme = ggplot2::theme_bw(base_size = 12))
data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/2023 Cataract Data.xlsx", sheet = "DND")
data <- data %>%  mutate(Family = as.numeric(family),
BCS = as.ordered(BCS),
Sex = Sex,
Treatment = relevel(as.factor(groups), ref = "Unirradiated"),
`Number of Tumors` = relevel(as.factor(`Number of Tumors`), ref = "No tumors"))
Status = data$`Cat 2.0`
Day = data$`Cat 2.0 day`
covariate_names <- c(Treatment = relevel(as.factor(data$groups), ref = "Unirradiated"),
sex=data$Sex,
`sex:female`="F",
Family = as.numeric(data$family),
CoatColor=data$"coat color",
BCS = as.ordered(data$BCS),
#Amyloidosis=data$Amyloidosis,
AML=data$`Acute Myeloid Leukemia`,
GCT=data$`Granulosa Cell Tumor`,
Hard_ACA=data$`Harderian Adenocarcinoma`,
Hard_Ad=data$`Harderian Adenoma`,
HCC=data$HCC,
Hist_Sarc=data$`Histiocytic Sarcoma`,
LSA_PreT=data$`LSA_T-cell`,
`LSA_B-cell`=data$`LSA_B-cell`,
Mamm_ACA=data$`Mammary Adenocarcinoma`,
OSA=data$`Osteosarcoma`,
Pulmonary_ACA = data$`Pulmonary Adenocarcinoma`,
Pituitary_Ad=data$`Pituitary Adenoma`,
STS=data$`Soft Tissue Sarcoma`,
Thyroid =data$`Thyroid Adenoma`,
Pigment_Dispersion = data$Pigment_Dispersion,
Did_not_dilate = data$`Did Not Dilate`)
covariate_names <- c(Treatment = relevel(as.factor(data$groups), ref = "Unirradiated"),
sex=data$sex,
`sex:female`="F",
Family = as.numeric(data$family),
CoatColor=data$"coat color",
BCS = as.ordered(data$BCS),
#Amyloidosis=data$Amyloidosis,
AML=data$`Acute Myeloid Leukemia`,
GCT=data$`Granulosa Cell Tumor`,
Hard_ACA=data$`Harderian Adenocarcinoma`,
Hard_Ad=data$`Harderian Adenoma`,
HCC=data$HCC,
Hist_Sarc=data$`Histiocytic Sarcoma`,
LSA_PreT=data$`LSA_T-cell`,
`LSA_B-cell`=data$`LSA_B-cell`,
Mamm_ACA=data$`Mammary Adenocarcinoma`,
OSA=data$`Osteosarcoma`,
Pulmonary_ACA = data$`Pulmonary Adenocarcinoma`,
Pituitary_Ad=data$`Pituitary Adenoma`,
STS=data$`Soft Tissue Sarcoma`,
Thyroid =data$`Thyroid Adenoma`,
Pigment_Dispersion = data$Pigment_Dispersion,
Did_not_dilate = data$`Did Not Dilate`)
covariate_names <- c(Treatment = relevel(as.factor(data$groups), ref = "Unirradiated"),
sex=data$sex,
`sex:female`="F",
Family = as.numeric(data$family),
CoatColor=data$"coat color",
BCS = as.ordered(data$BCS),
#Amyloidosis=data$Amyloidosis,
AML=data$`Acute Myeloid Leukemia`,
GCT=data$`Granulosa Cell Tumor`,
Hard_ACA=data$`Harderian Adenocarcinoma`,
Hard_Ad=data$`Harderian Adenoma`,
HCC=data$`Hepatocellular Carcinoma`,
Hist_Sarc=data$`Histiocytic Sarcoma`,
LSA_PreT=data$`LSA_T-cell`,
`LSA_B-cell`=data$`LSA_B-cell`,
Mamm_ACA=data$`Mammary Adenocarcinoma`,
OSA=data$`Osteosarcoma`,
Pulmonary_ACA = data$`Pulmonary Adenocarcinoma`,
Pituitary_Ad=data$`Pituitary Adenoma`,
STS=data$`Soft Tissue Sarcoma`,
Thyroid =data$`Thyroid Adenoma`,
Pigment_Dispersion = data$Pigment_Dispersion,
Did_not_dilate = data$`Did Not Dilate`)
data$`Hepatocellular Carcinoma`
data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/2023 Cataract Data.xlsx", sheet = "DND")
data <- data %>%  mutate(Family = as.numeric(family),
BCS = as.ordered(BCS),
Sex = Sex,
Treatment = relevel(as.factor(groups), ref = "Unirradiated"),
`Number of Tumors` = relevel(as.factor(`Number of Tumors`), ref = "No tumors"))
Status = data$`Cat 2.0`
Day = data$`Cat 2.0 day`
covariate_names <- c(Treatment = relevel(as.factor(data$groups), ref = "Unirradiated"),
sex=data$sex,
`sex:female`="F",
Family = as.numeric(data$family),
CoatColor=data$"coat color",
BCS = as.ordered(data$BCS),
#Amyloidosis=data$Amyloidosis,
AML=data$`Acute Myeloid Leukemia`,
GCT=data$`Granulosa Cell Tumor`,
Hard_ACA=data$`Harderian Adenocarcinoma`,
Hard_Ad=data$`Harderian Adenoma`,
HCC=data$`Hepatocellular Carcinoma`,
Hist_Sarc=data$`Histiocytic Sarcoma`,
LSA_PreT=data$`LSA_T-cell`,
`LSA_B-cell`=data$`LSA_B-cell`,
Mamm_ACA=data$`Mammary Adenocarcinoma`,
OSA=data$`Osteosarcoma`,
Pulmonary_ACA = data$`Pulmonary Adenocarcinoma`,
Pituitary_Ad=data$`Pituitary Adenoma`,
STS=data$`Soft Tissue Sarcoma`,
Thyroid =data$`Thyroid Adenoma`,
Pigment_Dispersion = data$Pigment_Dispersion,
Did_not_dilate = data$`Did Not Dilate`)
data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/2023 Cataract Data.xlsx", sheet = "DND")
data <- data %>%  mutate(Family = as.numeric(family),
BCS = as.ordered(BCS),
Sex = Sex,
Treatment = relevel(as.factor(groups), ref = "Unirradiated"),
`Number of Tumors` = relevel(as.factor(`Number of Tumors`), ref = "No tumors"))
Status = data$`Cat 2.0`
Day = data$`Cat 2.0 day`
covariate_names <- c(Treatment = relevel(as.factor(data$groups), ref = "Unirradiated"),
sex=data$sex,
`sex:female`="F",
Family = as.numeric(data$family),
CoatColor=data$"coat color",
BCS = as.ordered(data$BCS),
#Amyloidosis=data$Amyloidosis,
AML=data$`Acute Myeloid Leukemia`,
GCT=data$`Granulosa Cell Tumor`,
Hard_ACA=data$`Harderian Adenocarcinoma`,
Hard_Ad=data$`Harderian Adenoma`,
HCC=data$`Hepatocellular Carcinoma`,
Hist_Sarc=data$`Histiocytic Sarcoma`,
LSA_PreT=data$`LSA_T-cell`,
`LSA_B-cell`=data$`LSA_B-cell`,
Mamm_ACA=data$`Mammary Adenocarcinoma`,
OSA=data$`Osteosarcoma`,
Pulmonary_ACA = data$`Pulmonary Adenocarcinoma`,
Pituitary_Ad=data$`Pituitary Adenoma`,
STS=data$`Soft Tissue Sarcoma`,
Thyroid =data$`Thyroid Adenoma`,
Pigment_Dispersion = data$Pigment_Dispersion,
Did_not_dilate = data$`Did Not Dilate`)
df <- data %>% mutate(sex=rename_factor(sex, `M` = "male", `F` = "female"))
map(vars(Treatment, sex, #Family,
#`coat color`,
Pigment_Dispersion, `Did Not Dilate`, AML, GCT,
Hard_ACA, Hard_Ad, HCC, Hist_Sarc, LSA_PreT,
`LSA_B-cell`,Mamm_ACA,OSA,`Pulmonary Adenocarcinoma`,
Pituitary_Ad,STS,Thyroid,
`Number of Tumors`), function(by)
{
analyse_multivariate(df,
vars(Day, Status),
covariates = list(by), # covariates expects a list
covariate_name_dict = covariate_names)
}) %>%
forest_plot(factor_labeller = covariate_names,
endpoint_labeller = c(time="OS"),
orderer = ~order(HR),
labels_displayed = c("endpoint", "factor", "n"),
ggtheme = ggplot2::theme_bw(base_size = 12))
data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/2023 Cataract Data.xlsx", sheet = "DND")
data <- data %>%  mutate(Family = as.numeric(family),
BCS = as.ordered(BCS),
Sex = Sex,
Treatment = relevel(as.factor(groups), ref = "Unirradiated"),
`Number of Tumors` = relevel(as.factor(`Number of Tumors`), ref = "No tumors"))
data <- data %>%  mutate(Family = as.numeric(family),
BCS = as.ordered(BCS),
Sex = sex,
Treatment = relevel(as.factor(groups), ref = "Unirradiated"),
`Number of Tumors` = relevel(as.factor(`Number of Tumors`), ref = "No tumors"))
Status = data$`Cat 2.0`
Day = data$`Cat 2.0 day`
covariate_names <- c(Treatment = relevel(as.factor(data$groups), ref = "Unirradiated"),
sex=data$sex,
`sex:female`="F",
Family = as.numeric(data$family),
CoatColor=data$"coat color",
BCS = as.ordered(data$BCS),
#Amyloidosis=data$Amyloidosis,
AML=data$`Acute Myeloid Leukemia`,
GCT=data$`Granulosa Cell Tumor`,
Hard_ACA=data$`Harderian Adenocarcinoma`,
Hard_Ad=data$`Harderian Adenoma`,
HCC=data$`Hepatocellular Carcinoma`,
Hist_Sarc=data$`Histiocytic Sarcoma`,
LSA_PreT=data$`LSA_T-cell`,
`LSA_B-cell`=data$`LSA_B-cell`,
Mamm_ACA=data$`Mammary Adenocarcinoma`,
OSA=data$`Osteosarcoma`,
Pulmonary_ACA = data$`Pulmonary Adenocarcinoma`,
Pituitary_Ad=data$`Pituitary Adenoma`,
STS=data$`Soft Tissue Sarcoma`,
Thyroid =data$`Thyroid Adenoma`,
Pigment_Dispersion = data$Pigment_Dispersion,
Did_not_dilate = data$`Did Not Dilate`)
df <- data %>% mutate(sex=rename_factor(sex, `M` = "male", `F` = "female"))
map(vars(Treatment, sex, #Family,
#`coat color`,
Pigment_Dispersion, `Did Not Dilate`, AML, GCT,
Hard_ACA, Hard_Ad, HCC, Hist_Sarc, LSA_PreT,
`LSA_B-cell`,Mamm_ACA,OSA,`Pulmonary Adenocarcinoma`,
Pituitary_Ad,STS,Thyroid,
`Number of Tumors`), function(by)
{
analyse_multivariate(df,
vars(Day, Status),
covariates = list(by), # covariates expects a list
covariate_name_dict = covariate_names)
}) %>%
forest_plot(factor_labeller = covariate_names,
endpoint_labeller = c(time="OS"),
orderer = ~order(HR),
labels_displayed = c("endpoint", "factor", "n"),
ggtheme = ggplot2::theme_bw(base_size = 12))
data$`Acute Myeloid Leukemia`,
data$`Acute Myeloid Leukemia`
covariate_names <- c(Treatment = relevel(as.factor(data$groups), ref = "Unirradiated"),
sex=data$sex,
`sex:female`="F",
Family = as.numeric(data$family),
CoatColor=data$"coat color",
BCS = as.ordered(data$BCS),
#Amyloidosis=data$Amyloidosis,
AML=data$`Acute Myeloid Leukemia`,
GCT=data$`Granulosa Cell Tumor`,
Hard_ACA=data$`Harderian Adenocarcinoma`,
Hard_Ad=data$`Harderian Adenoma`,
HCC=data$`Hepatocellular Carcinoma`,
Hist_Sarc=data$`Histiocytic Sarcoma`,
LSA_PreT=data$`LSA_T-cell`,
`LSA_B-cell`=data$`LSA_B-cell`,
Mamm_ACA=data$`Mammary Adenocarcinoma`,
OSA=data$`Osteosarcoma`,
Pulmonary_ACA = data$`Pulmonary Adenocarcinoma`,
Pituitary_Ad=data$`Pituitary Adenoma`,
STS=data$`Soft Tissue Sarcoma`,
Thyroid =data$`Thyroid Adenoma`,
Pigment_Dispersion = data$Pigment_Dispersion,
Did_not_dilate = data$`Did Not Dilate`)
df <- data %>% mutate(sex=rename_factor(sex, `M` = "male", `F` = "female"))
map(vars(Treatment, sex, #Family,
#`coat color`,
Pigment_Dispersion, `Did Not Dilate`, AML, GCT,
Hard_ACA, Hard_Ad, HCC, Hist_Sarc, LSA_PreT,
`LSA_B-cell`,Mamm_ACA,OSA,`Pulmonary Adenocarcinoma`,
Pituitary_Ad,STS,Thyroid,
`Number of Tumors`), function(by)
{
analyse_multivariate(df,
vars(Day, Status),
covariates = list(by), # covariates expects a list
covariate_name_dict = covariate_names)
}) %>%
forest_plot(factor_labeller = covariate_names,
endpoint_labeller = c(time="OS"),
orderer = ~order(HR),
labels_displayed = c("endpoint", "factor", "n"),
ggtheme = ggplot2::theme_bw(base_size = 12))
map(vars(Treatment, sex, #Family,
#`coat color`,
Pigment_Dispersion, `Did Not Dilate`,
`Acute Myeloid Leukemia`, `Granulosa Cell Tumor`,
Hard_ACA, Hard_Ad, HCC, Hist_Sarc, LSA_PreT,
`LSA_B-cell`,Mamm_ACA,OSA,`Pulmonary Adenocarcinoma`,
Pituitary_Ad,STS,Thyroid,
`Number of Tumors`), function(by)
{
analyse_multivariate(df,
vars(Day, Status),
covariates = list(by), # covariates expects a list
covariate_name_dict = covariate_names)
}) %>%
forest_plot(factor_labeller = covariate_names,
endpoint_labeller = c(time="OS"),
orderer = ~order(HR),
labels_displayed = c("endpoint", "factor", "n"),
ggtheme = ggplot2::theme_bw(base_size = 12))
map(vars(Treatment, sex, #Family,
#`coat color`,
Pigment_Dispersion, `Did Not Dilate`,
`Acute Myeloid Leukemia`, `Granulosa Cell Tumor`,
`Harderian Adenocarcinoma`, `Harderian Adenoma`, `Hepatocellular Carcinoma`, `Histiocytic Sarcoma`, `LSA_T-cell`,
`LSA_B-cell`,`Mammary Adenocarcinoma`,`Osteosarcoma`,`Pulmonary Adenocarcinoma`,
`Pituitary Adenoma`,`Soft Tissue Sarcoma`,`Thyroid Adenoma`,
`Number of Tumors`), function(by)
{
analyse_multivariate(df,
vars(Day, Status),
covariates = list(by), # covariates expects a list
covariate_name_dict = covariate_names)
}) %>%
forest_plot(factor_labeller = covariate_names,
endpoint_labeller = c(time="OS"),
orderer = ~order(HR),
labels_displayed = c("endpoint", "factor", "n"),
ggtheme = ggplot2::theme_bw(base_size = 12))
data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/2023 Cataract Data.xlsx", sheet = "DND")
data <- data %>%  mutate(Family = as.numeric(family),
BCS = as.ordered(BCS),
Sex = sex,
Treatment = relevel(as.factor(groups), ref = "Unirradiated"),
`Number of Tumors` = relevel(as.factor(`Number of Tumors`), ref = "No tumors"))
Status = data$`Cat 2.0`
Day = data$`Cat 2.0 day`
covariate_names <- c(Treatment = relevel(as.factor(data$groups), ref = "Unirradiated"),
sex=data$sex,
`sex:female`="F",
Family = as.numeric(data$family),
CoatColor=data$"coat color",
BCS = as.ordered(data$BCS),
#Amyloidosis=data$Amyloidosis,
AML=data$`Acute Myeloid Leukemia`,
GCT=data$`Granulosa Cell Tumor`,
Hard_ACA=data$`Harderian Adenocarcinoma`,
Hard_Ad=data$`Harderian Adenoma`,
HCC=data$`Hepatocellular Carcinoma`,
Hist_Sarc=data$`Histiocytic Sarcoma`,
LSA_PreT=data$`LSA_T-cell`,
`LSA_B-cell`=data$`LSA_B-cell`,
Mamm_ACA=data$`Mammary Adenocarcinoma`,
OSA=data$`Osteosarcoma`,
Pulmonary_ACA = data$`Pulmonary Adenocarcinoma`,
Pituitary_Ad=data$`Pituitary Adenoma`,
STS=data$`Soft Tissue Sarcoma`,
Thyroid =data$`Thyroid Adenoma`,
Pigment_Dispersion = data$Pigment_Dispersion,
Did_not_dilate = data$`Did Not Dilate`)
df <- data %>% mutate(sex=rename_factor(sex, `M` = "male", `F` = "female"))
map(vars(Treatment, sex, #Family,
#`coat color`,
Pigment_Dispersion, `Did Not Dilate`,
`Acute Myeloid Leukemia`, `Granulosa Cell Tumor`,
`Harderian Adenocarcinoma`, `Harderian Adenoma`, `Hepatocellular Carcinoma`, `Histiocytic Sarcoma`, `LSA_T-cell`,
`LSA_B-cell`,`Mammary Adenocarcinoma`,`Osteosarcoma`,`Pulmonary Adenocarcinoma`,
`Pituitary Adenoma`,`Soft Tissue Sarcoma`,`Thyroid Adenoma`,
`Number of Tumors`), function(by)
{
analyse_multivariate(df,
vars(Day, Status),
covariates = list(by), # covariates expects a list
covariate_name_dict = covariate_names)
}) %>%
forest_plot(factor_labeller = covariate_names,
endpoint_labeller = c(time="OS"),
orderer = ~order(HR),
labels_displayed = c("endpoint", "factor", "n"),
ggtheme = ggplot2::theme_bw(base_size = 12))
