resultsCC <- dplyr::select(resultsGO, Estimate, Contrast, ENTREZID)
head(resultsCC)
summary(resultsCC)
names(resultsCC)
names(resultsGO)
mt_list = split(resultsCC, f = resultsCC$Contrast)
resultsCC$ENTREZID
str(mt_list)
ids <- unique(resultsCC$Contrast)
unique(resultsCC$Contrast)
ids <- unique(resultsCC$Contrast)
mt_list<-list()
for(i in 1:length(ids)){
id <- ids[i]
df <- dplyr::filter(resultsCC, resultsCC$Contrast == id)
mt_list[[i]]<-  as.character(df$ENTREZID)
}
###CHECK THAT ROW NAMES ARE ACCURATE
names(mt_list1) <- c(ids)
str(mt_list1)
###CHECK THAT ROW NAMES ARE ACCURATE
names(mt_list) <- c(ids)
str(mt_list)
ck <- compareCluster(geneCluster = mt_list1,
fun = enrichGO, #"groupGO", "enrichGO", "enrichKEGG", "enrichDO" or "enrichPathway"
ont = "BP",
OrgDb = org.Mm.eg.db)
ck <- compareCluster(geneCluster = mt_list,
fun = enrichGO, #"groupGO", "enrichGO", "enrichKEGG", "enrichDO" or "enrichPathway"
ont = "BP",
OrgDb = org.Mm.eg.db)
ck <- setReadable(ck, OrgDb = org.Mm.eg.db, keyType="ENTREZID")
head(ck)
dotplot(ck)
resultsGO <- dplyr::filter(results, results$Estimate > 0.5 & results$'Pr(>|t|)' < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 1.0 & results$'Pr(>|t|)' < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$FDR < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$FDR < 0.01)
summary(resultsGO)
#gcSample =  list of different samples
resultsCC <- dplyr::select(resultsGO, Estimate, Contrast, ENTREZID)
unique(resultsCC$Contrast)
#Create a list containing gene IDs for each category
ids <- unique(resultsCC$Contrast)
mt_list<-list()
for(i in 1:length(ids)){
id <- ids[i]
df <- dplyr::filter(resultsCC, resultsCC$Contrast == id)
mt_list[[i]]<-  as.character(df$ENTREZID)
}
###CHECK THAT ROW NAMES ARE ACCURATE
names(mt_list) <- c(ids)
str(mt_list)
ck <- compareCluster(geneCluster = mt_list,
fun = enrichGO, #"groupGO", "enrichGO", "enrichKEGG", "enrichDO" or "enrichPathway"
ont = "BP",
OrgDb = org.Mm.eg.db)
ck <- setReadable(ck, OrgDb = org.Mm.eg.db, keyType="ENTREZID")
head(ck)
dotplot(ck)
resultsGO <- dplyr::filter(results, results$Estimate < -0.5 & results$'Pr(>|t|)' < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 1.0 & results$'Pr(>|t|)' < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$FDR < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$FDR < 0.01)
summary(resultsGO)
#gcSample =  list of different samples
resultsCC <- dplyr::select(resultsGO, Estimate, Contrast, ENTREZID)
unique(resultsCC$Contrast)
#Create a list containing gene IDs for each category
ids <- unique(resultsCC$Contrast)
mt_list<-list()
for(i in 1:length(ids)){
id <- ids[i]
df <- dplyr::filter(resultsCC, resultsCC$Contrast == id)
mt_list[[i]]<-  as.character(df$ENTREZID)
}
###CHECK THAT ROW NAMES ARE ACCURATE
names(mt_list) <- c(ids)
str(mt_list)
ck <- compareCluster(geneCluster = mt_list,
fun = enrichGO, #"groupGO", "enrichGO", "enrichKEGG", "enrichDO" or "enrichPathway"
ont = "BP",
OrgDb = org.Mm.eg.db)
ck <- setReadable(ck, OrgDb = org.Mm.eg.db, keyType="ENTREZID")
head(ck)
dotplot(ck)
#load("C:/Users/edmondsonef/Desktop/DSP GeoMx/Results/KPC_geoMX_new.RData")
#results <- read.csv("C:/Users/edmondsonef/Desktop/DSP GeoMx/Results/07.06.22_comps_MHL_no.int.csv")
#results <- read.csv("C:/Users/edmondsonef/Desktop/DSP GeoMx/Results/07.06.22_comps_MHL_WITH.int.csv")
#results <- read.csv("C:/Users/edmondsonef/Desktop/DSP GeoMx/Results/07.08.22_class_MHL_no_int.csv")
#results <- read.csv("C:/Users/edmondsonef/Desktop/DSP GeoMx/Results/GENELIST_11-2-22_MHL_class_with_int.csv")
results <- read.csv("C:/Users/edmondsonef/Desktop/DSP GeoMx/Results/11-3-22_MHL_progression2_with_int.csv")
head(results)
names(results)[2] <- 'SYMBOL'
names(results)[6] <- 'Pr(>|t|)'
head(results)
eg <- bitr(results$SYMBOL, fromType="SYMBOL", toType=c("ENTREZID"), #toType=c("ENSEMBL", "ENTREZID", "UNIPROT"),
OrgDb="org.Mm.eg.db")
results <- dplyr::left_join(results, eg, by = "SYMBOL")
rm(eg)
universe <- distinct(results, SYMBOL, .keep_all = T)
head(universe)
resultsGO <- dplyr::filter(results, results$Estimate < -0.5 & results$'Pr(>|t|)' < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 1.0 & results$'Pr(>|t|)' < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$FDR < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$FDR < 0.01)
summary(resultsGO)
#gcSample =  list of different samples
resultsCC <- dplyr::select(resultsGO, Estimate, Contrast, ENTREZID)
unique(resultsCC$Contrast)
resultsCC <- dplyr::filter(resultsCC, Contrast == c("1-Normal acini - 3-ADM",
"3-ADM - 4-PanIN",
"4-PanIN - 5-PDAC"))
ids <- unique(resultsCC$Contrast)
mt_list<-list()
for(i in 1:length(ids)){
id <- ids[i]
df <- dplyr::filter(resultsCC, resultsCC$Contrast == id)
mt_list[[i]]<-  as.character(df$ENTREZID)
}
###CHECK THAT ROW NAMES ARE ACCURATE
names(mt_list) <- c(ids)
str(mt_list)
ck <- compareCluster(geneCluster = mt_list,
fun = enrichGO, #"groupGO", "enrichGO", "enrichKEGG", "enrichDO" or "enrichPathway"
ont = "BP",
OrgDb = org.Mm.eg.db)
ck <- setReadable(ck, OrgDb = org.Mm.eg.db, keyType="ENTREZID")
head(ck)
dotplot(ck)
set.seed(2022-11-2)
selected_pathways <- c("synapse organization",
"gliogenesis",
"axonogenesis",
"cell-substrate adhesion",
"oligodendrocyte development")
dotplot(ck, showCategory = selected_pathways, font.size=14)
selected_pathways <- c("synapse organization",
"gliogenesis",
"axonogenesis",
"cell-substrate adhesion",
"oligodendrocyte development",
"neurogenesis",
"cell-substrate adhesion",
"regulation of actin cytoskeleton organization")
dotplot(ck, showCategory = selected_pathways, font.size=14)
selected_pathways <- c("synapse organization",
"synaptogenesis",
"gliogenesis",
"axonogenesis",
"cell-substrate adhesion",
"oligodendrocyte development",
"neurogenesis",
"cell-substrate adhesion",
"regulation of actin cytoskeleton organization")
dotplot(ck, showCategory = selected_pathways, font.size=14)
cnetplot(ck, node_label="category", showCategory = selected_pathways,
cex_label_category = 1.2)
cnetplot(ck, node_label="gene",showCategory = selected_pathways,
cex_label_category = 1.2)
cnetplot(ck, node_label="all", showCategory = selected_pathways,
cex_label_category = 1.2)
ck <- pairwise_termsim(ck)
ck2 <- simplify(ck, cutoff=0.7, by="p.adjust", select_fun=min)
dotplot(ck2)
selected_pathways <- c("synapse organization",
"synaptogenesis",
"gliogenesis",
"axonogenesis",
"cell-substrate adhesion",
"oligodendrocyte development",
"neurogenesis",
"cell-substrate adhesion",
"regulation of actin cytoskeleton organization")
dotplot(ck, showCategory = selected_pathways, font.size=14)
cnetplot(ck, node_label="all", showCategory = selected_pathways,
cex_label_category = 1.2)
#load("C:/Users/edmondsonef/Desktop/DSP GeoMx/Results/KPC_geoMX_new.RData")
#results <- read.csv("C:/Users/edmondsonef/Desktop/DSP GeoMx/Results/07.06.22_comps_MHL_no.int.csv")
results <- read.csv("C:/Users/edmondsonef/Desktop/DSP GeoMx/Results/07.06.22_comps_MHL_WITH.int.csv")
head(results)
names(results)[2] <- 'SYMBOL'
names(results)[6] <- 'Pr(>|t|)'
head(results)
eg <- bitr(results$SYMBOL, fromType="SYMBOL", toType=c("ENTREZID"), #toType=c("ENSEMBL", "ENTREZID", "UNIPROT"),
OrgDb="org.Mm.eg.db")
results <- dplyr::left_join(results, eg, by = "SYMBOL")
rm(eg)
universe <- distinct(results, SYMBOL, .keep_all = T)
head(universe)
resultsGO <- dplyr::filter(results, abs(results$Estimate) > 1.0 & results$'Pr(>|t|)' < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$FDR < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$FDR < 0.01)
summary(resultsGO)
#gcSample =  list of different samples
resultsCC <- dplyr::select(resultsGO, Estimate, Contrast, ENTREZID)
unique(resultsCC$Contrast)
#load("C:/Users/edmondsonef/Desktop/DSP GeoMx/Results/KPC_geoMX_new.RData")
#results <- read.csv("C:/Users/edmondsonef/Desktop/DSP GeoMx/Results/07.06.22_comps_MHL_no.int.csv")
results <- read.csv("C:/Users/edmondsonef/Desktop/DSP GeoMx/Results/07.06.22_comps_MHL_WITH.int.csv")
head(results)
names(results)[2] <- 'SYMBOL'
names(results)[6] <- 'Pr(>|t|)'
head(results)
#resultsGO <- dplyr::filter(results, results$Estimate > 0.5 & results$'Pr(>|t|)' < 0.05)
#resultsGO <- dplyr::filter(results, results$Estimate < -0.5 & results$'Pr(>|t|)' < 0.05)
resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$'Pr(>|t|)' < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 1.0 & results$'Pr(>|t|)' < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$FDR < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$FDR < 0.01)
summary(resultsGO)
#gcSample =  list of different samples
resultsCC <- dplyr::select(resultsGO, Estimate, Contrast, ENTREZID)
unique(resultsCC$Contrast)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 1.0 & results$'Pr(>|t|)' < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$FDR < 0.05)
resultsGO <- dplyr::filter(results, abs(results$Estimate) > 1.0 & results$FDR < 0.01)
summary(resultsGO)
#gcSample =  list of different samples
resultsCC <- dplyr::select(resultsGO, Estimate, Contrast, ENTREZID)
unique(resultsCC$Contrast)
#Create a list containing gene IDs for each category
ids <- unique(resultsCC$Contrast)
mt_list<-list()
for(i in 1:length(ids)){
id <- ids[i]
df <- dplyr::filter(resultsCC, resultsCC$Contrast == id)
mt_list[[i]]<-  as.character(df$ENTREZID)
}
###CHECK THAT ROW NAMES ARE ACCURATE
names(mt_list) <- c(ids)
str(mt_list)
ck <- compareCluster(geneCluster = mt_list,
fun = enrichGO, #"groupGO", "enrichGO", "enrichKEGG", "enrichDO" or "enrichPathway"
ont = "BP",
OrgDb = org.Mm.eg.db)
ck <- setReadable(ck, OrgDb = org.Mm.eg.db, keyType="ENTREZID")
head(ck)
dotplot(ck)
selected_pathways <- c("synapse organization",
"synaptogenesis",
"gliogenesis",
"axonogenesis",
"cell-substrate adhesion",
"oligodendrocyte development",
"neurogenesis",
"cell-substrate adhesion",
"regulation of actin cytoskeleton organization")
dotplot(ck, showCategory = selected_pathways, font.size=14)
dotplot(ck, showCategory = selected_pathways, font.size=10)
#load("C:/Users/edmondsonef/Desktop/DSP GeoMx/Results/KPC_geoMX_new.RData")
#results <- read.csv("C:/Users/edmondsonef/Desktop/DSP GeoMx/Results/07.06.22_comps_MHL_no.int.csv")
results <- read.csv("C:/Users/edmondsonef/Desktop/DSP GeoMx/Results/07.06.22_comps_MHL_WITH.int.csv")
head(results)
names(results)[6] <- 'Pr(>|t|)'
head(results)
universe <- distinct(results, SYMBOL, .keep_all = T)
head(universe)
resultsGO <- dplyr::filter(results, results$Estimate > 0.5 & results$FDR < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$'Pr(>|t|)' < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 1.0 & results$'Pr(>|t|)' < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$FDR < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 1.0 & results$FDR < 0.01)
summary(resultsGO)
#gcSample =  list of different samples
resultsCC <- dplyr::select(resultsGO, Estimate, Contrast, ENTREZID)
unique(resultsCC$Contrast)
resultsCC <- dplyr::filter(resultsCC, Contrast == c("4-PanINlo - 6-PDAC",
"1-Normal acini - 4-PanINlo",
"1-Normal acini - 5-PanINhi",
"5-PanINhi - 6-PDAC",
"2-Bystander - 4-PanINlo",
"2-Bystander - 5-PanINhi",
"3-ADM - 4-PanINlo",
"3-ADM - 5-PanINhi"))
#Create a list containing gene IDs for each category
ids <- unique(resultsCC$Contrast)
mt_list<-list()
for(i in 1:length(ids)){
id <- ids[i]
df <- dplyr::filter(resultsCC, resultsCC$Contrast == id)
mt_list[[i]]<-  as.character(df$ENTREZID)
}
###CHECK THAT ROW NAMES ARE ACCURATE
names(mt_list) <- c(ids)
str(mt_list)
ck <- compareCluster(geneCluster = mt_list,
fun = enrichGO, #"groupGO", "enrichGO", "enrichKEGG", "enrichDO" or "enrichPathway"
ont = "BP",
OrgDb = org.Mm.eg.db)
ck <- setReadable(ck, OrgDb = org.Mm.eg.db, keyType="ENTREZID")
head(ck)
dotplot(ck)
selected_pathways <- c("synapse organization",
"synaptogenesis",
"gliogenesis",
"axonogenesis",
"cell-substrate adhesion",
"oligodendrocyte development",
"neurogenesis",
"cell-substrate adhesion",
"regulation of actin cytoskeleton organization")
dotplot(ck, showCategory = selected_pathways, font.size=10)
resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$'Pr(>|t|)' < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 1.0 & results$'Pr(>|t|)' < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$FDR < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$FDR < 0.01)
summary(resultsGO)
mt_list = split(resultsGO, f = resultsGO$Contrast)
summary(mt_list)
mt_list[[23]]
summary(mt_list)[[23]]
summary(mt_list[[23]])
names(mt_list[[23]])
names(mt_list)
head(mt_list[[23]]$Contrast)
gene <- mt_list[[23]]
head(gene)
ego <- enrichGO(gene          = gene$ENTREZID,
keyType       = "ENTREZID",
universe      = universe$ENTREZID, ##list of all genes??
OrgDb         = org.Mm.eg.db,
ont           = "BP", #"BP", "MF", and "CC"
pAdjustMethod = "BH",
pvalueCutoff  = 0.01,
qvalueCutoff  = 0.05,
readable      = TRUE)
dotplot(ego)
selected_pathways <- c("synapse organization",
"synaptogenesis",
"gliogenesis",
"axonogenesis",
"cell-substrate adhesion",
"oligodendrocyte development",
"neurogenesis",
"cell-substrate adhesion",
"regulation of actin cytoskeleton organization")
dotplot(ck, showCategory = selected_pathways, font.size=10)
dotplot(ego, showCategory = selected_pathways, font.size=10)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$'Pr(>|t|)' < 0.05)
resultsGO <- dplyr::filter(results, abs(results$Estimate) > 1.0 & results$'Pr(>|t|)' < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$FDR < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$FDR < 0.01)
summary(resultsGO)
mt_list = split(resultsGO, f = resultsGO$Contrast)
summary(mt_list)
names(mt_list)
head(mt_list[[23]]$Contrast)
gene <- mt_list[[23]]
head(gene)
ego <- enrichGO(gene          = gene$ENTREZID,
keyType       = "ENTREZID",
universe      = universe$ENTREZID, ##list of all genes??
OrgDb         = org.Mm.eg.db,
ont           = "BP", #"BP", "MF", and "CC"
pAdjustMethod = "BH",
pvalueCutoff  = 0.01,
qvalueCutoff  = 0.05,
readable      = TRUE)
dotplot(ego)
selected_pathways <- c("synapse organization",
"synaptogenesis",
"gliogenesis",
"axonogenesis",
"cell-substrate adhesion",
"oligodendrocyte development",
"neurogenesis",
"cell-substrate adhesion",
"regulation of actin cytoskeleton organization")
dotplot(ego, showCategory = selected_pathways, font.size=10)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$'Pr(>|t|)' < 0.05)
resultsGO <- dplyr::filter(results, abs(results$Estimate) > 2.0 & results$'Pr(>|t|)' < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$FDR < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$FDR < 0.01)
summary(resultsGO)
mt_list = split(resultsGO, f = resultsGO$Contrast)
summary(mt_list)
names(mt_list)
head(mt_list[[23]]$Contrast)
gene <- mt_list[[23]]
head(gene)
ego <- enrichGO(gene          = gene$ENTREZID,
keyType       = "ENTREZID",
universe      = universe$ENTREZID, ##list of all genes??
OrgDb         = org.Mm.eg.db,
ont           = "BP", #"BP", "MF", and "CC"
pAdjustMethod = "BH",
pvalueCutoff  = 0.01,
qvalueCutoff  = 0.05,
readable      = TRUE)
dotplot(ego)
head(ego,10)
#results <- read.csv("C:/Users/edmondsonef/Desktop/DSP GeoMx/Results/07.06.22_comps_MHL_no.int.csv")
results <- read.csv("C:/Users/edmondsonef/Desktop/DSP GeoMx/Results/07.06.22_comps_MHL_WITH.int.csv")
head(results)
names(results)[6] <- 'Pr(>|t|)'
head(results)
universe <- distinct(results, SYMBOL, .keep_all = T)
head(universe)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$'Pr(>|t|)' < 0.05)
resultsGO <- dplyr::filter(results, abs(results$Estimate) > 1.0 & results$FDR < 0.05)
#results <- read.csv("C:/Users/edmondsonef/Desktop/DSP GeoMx/Results/07.06.22_comps_MHL_no.int.csv")
results <- read.csv("C:/Users/edmondsonef/Desktop/DSP GeoMx/Results/07.06.22_comps_MHL_WITH.int.csv")
head(results)
names(results)[6] <- 'Pr(>|t|)'
universe <- distinct(results, SYMBOL, .keep_all = T)
head(universe)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$'Pr(>|t|)' < 0.05)
resultsGO <- dplyr::filter(results, abs(results$Estimate) > 1.0 & results$FDR < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$FDR < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$FDR < 0.01)
summary(resultsGO)
mt_list = split(resultsGO, f = resultsGO$Contrast)
summary(mt_list)
names(mt_list)
head(mt_list[[23]]$Contrast)
gene <- mt_list[[23]]
head(gene)
ego <- enrichGO(gene          = gene$ENTREZID,
keyType       = "ENTREZID",
universe      = universe$ENTREZID, ##list of all genes??
OrgDb         = org.Mm.eg.db,
ont           = "BP", #"BP", "MF", and "CC"
pAdjustMethod = "BH",
pvalueCutoff  = 0.01,
qvalueCutoff  = 0.05,
readable      = TRUE)
dotplot(ego)
selected_pathways <- c("synapse organization",
"synaptogenesis",
"gliogenesis",
"axonogenesis",
"cell-substrate adhesion",
"oligodendrocyte development",
"neurogenesis",
"cell-substrate adhesion",
"regulation of actin cytoskeleton organization")
dotplot(ego, showCategory = selected_pathways, font.size=10)
head(ego,10)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$'Pr(>|t|)' < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 1.0 & results$'Pr(>|t|)' < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$FDR < 0.05)
#resultsGO <- dplyr::filter(results, abs(results$Estimate) > 1.0 & results$FDR < 0.01)
summary(resultsGO)
#gcSample =  list of different samples
resultsCC <- dplyr::select(resultsGO, Estimate, Contrast, ENTREZID)
unique(resultsCC$Contrast)
resultsCC <- dplyr::filter(resultsCC, Contrast == c("4-PanINlo - 6-PDAC",
"1-Normal acini - 4-PanINlo",
"1-Normal acini - 5-PanINhi",
"5-PanINhi - 6-PDAC",
"2-Bystander - 4-PanINlo",
"2-Bystander - 5-PanINhi",
"3-ADM - 4-PanINlo",
"3-ADM - 5-PanINhi"))
#Create a list containing gene IDs for each category
ids <- unique(resultsCC$Contrast)
mt_list<-list()
for(i in 1:length(ids)){
id <- ids[i]
df <- dplyr::filter(resultsCC, resultsCC$Contrast == id)
mt_list[[i]]<-  as.character(df$ENTREZID)
}
###CHECK THAT ROW NAMES ARE ACCURATE
names(mt_list) <- c(ids)
str(mt_list)
ck <- compareCluster(geneCluster = mt_list,
fun = enrichGO, #"groupGO", "enrichGO", "enrichKEGG", "enrichDO" or "enrichPathway"
ont = "BP", OrgDb = org.Mm.eg.db)
ck <- setReadable(ck, OrgDb = org.Mm.eg.db, keyType="ENTREZID")
head(ck)
dotplot(ck)
set.seed(2022-11-2)
selected_pathways <- c("synapse organization",
"synaptogenesis",
"gliogenesis",
"axonogenesis",
"cell-substrate adhesion",
"oligodendrocyte development",
"neurogenesis",
"cell-substrate adhesion",
"regulation of actin cytoskeleton organization")
dotplot(ck, showCategory = selected_pathways, font.size=10)
names(mt_list)
mt_list = split(resultsGO, f = resultsGO$Contrast)
summary(mt_list)
names(mt_list)
head(mt_list[[27]]$Contrast)
gene <- mt_list[[27]]
head(gene)
universe$ENTREZID
ego <- enrichGO(gene          = gene$ENTREZID,
keyType       = "ENTREZID",
universe      = universe$ENTREZID, ##list of all genes??
OrgDb         = org.Mm.eg.db,
ont           = "BP", #"BP", "MF", and "CC"
pAdjustMethod = "BH",
pvalueCutoff  = 0.01,
qvalueCutoff  = 0.05,
readable      = TRUE)
dotplot(ego)
universe <- distinct(results, SYMBOL, .keep_all = T)
head(universe)
ego <- enrichGO(gene          = gene$ENTREZID,
keyType       = "ENTREZID",
universe      = universe$ENTREZID, ##list of all genes??
OrgDb         = org.Mm.eg.db,
ont           = "BP", #"BP", "MF", and "CC"
pAdjustMethod = "BH",
pvalueCutoff  = 0.01,
qvalueCutoff  = 0.05,
readable      = TRUE)
