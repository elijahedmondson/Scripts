results$Color[abs(results$Estimate) < 0.5] <- "NS or FC < 0.5"
results$Color <- factor(results$Color, levels = c("NS or FC < 0.5", "P < 0.05", "FDR < 0.05", "FDR < 0.001"))
dplyr::count(results, FDR < 0.001)
dplyr::count(results, FDR < 0.05)
dplyr::count(results, `Pr(>|t|)` < 0.05)
results$invert_P <- (-log10(results$`Pr(>|t|)`)) * sign(results$Estimate)
top_g <- c()
for(genotype in c("PV/N", "N/N")) {
ind <- results$Subset == genotype
top_g <- c(top_g,
results[ind, 'Gene'][
order(results[ind, 'invert_P'], decreasing = TRUE)[1:50]],
results[ind, 'Gene'][
order(results[ind, 'invert_P'], decreasing = FALSE)[1:50]])
}
top_g <- unique(top_g)
top_g
#reverse log fold change to fit with label
results$Estimate1 <- results$Estimate*(-1)
# Graph results
volc_plot <- ggplot(results,                                                             ###CHANGE
aes(x = Estimate1, y = -log10(`Pr(>|t|)`),
color = Color, label = Gene)) +
geom_vline(xintercept = c(0.5, -0.5), lty = "dashed") +
geom_hline(yintercept = -log10(0.05), lty = "dashed") +
geom_point() +
labs(x = " <- log2(FC) -> ",                                       ###CHANGE
y = "Significance, -log10(P)",
color = "Significance") +
scale_color_manual(values = c(`FDR < 0.001` = "dodgerblue", `FDR < 0.05` = "lightblue",
`P < 0.05` = "orange2",`NS or FC < 0.5` = "gray"),
guide = guide_legend(override.aes = list(size = 4))) +
scale_y_continuous(expand = expansion(mult = c(0,0.05))) +
geom_text_repel(data = subset(results, Gene %in% top_g & FDR < 0.001 & abs(results$Estimate1) > 0.7),
size = 6, point.padding = 0.15, color = "black",
min.segment.length = .1, box.padding = .2, #lwd = 2,
max.overlaps = 50) +
theme_bw(base_size = 15) +
theme(legend.position = "bottom")+
facet_wrap(~Subset, scales = "free_y")
volc_plot
# Graph results
volc_plot <- ggplot(results,                                                             ###CHANGE
aes(x = Estimate1, y = -log10(`Pr(>|t|)`),
color = Color, label = Gene)) +
geom_vline(xintercept = c(0.5, -0.5), lty = "dashed") +
geom_hline(yintercept = -log10(0.05), lty = "dashed") +
geom_point() +
labs(x = " <- log2(FC) -> ",                                       ###CHANGE
y = "Significance, -log10(P)",
color = "Significance") +
scale_color_manual(values = c(`FDR < 0.001` = "dodgerblue", `FDR < 0.05` = "lightblue",
`P < 0.05` = "orange2",`NS or FC < 0.5` = "gray"),
guide = guide_legend(override.aes = list(size = 4))) +
scale_y_continuous(expand = expansion(mult = c(0,0.05))) +
geom_text_repel(data = subset(results, Gene %in% top_g & FDR < 0.1 & abs(results$Estimate1) > 0.7),
size = 6, point.padding = 0.15, color = "black",
min.segment.length = .1, box.padding = .2, #lwd = 2,
max.overlaps = 50) +
theme_bw(base_size = 15) +
theme(legend.position = "bottom")
volc_plot
for(genotype in c("PV/N", "N/N")) {
ind <- results$Subset == genotype
top_g <- c(top_g,
results[ind, 'Gene'][
order(results[ind, 'invert_P'], decreasing = TRUE)[1:50]],
results[ind, 'Gene'][
order(results[ind, 'invert_P'], decreasing = FALSE)[1:50]])
}
top_g <- unique(top_g)
top_g
library(VennDiagram)
library(gridExtra)
library(readxl)
library(ggpubr)
library(Rmisc)
library(tidyverse)
library(plyr)
library(GGally)
library(ggplot2)
library(tidyverse)
library(gapminder)
library(dplyr)
library(RColorBrewer)
myCol <- brewer.pal(4, "Pastel2")
#### FORMAT DATA
head(results)
names(results)[1]
names(results)[1] <- 'SYMBOL'
eg <- bitr(results$SYMBOL, fromType="SYMBOL", toType=c("ENTREZID"),OrgDb="org.Mm.eg.db")
results <- dplyr::left_join(results, eg, by = "SYMBOL")
rm(eg)
universe <- distinct(results, SYMBOL, .keep_all = T)
head(universe)
write.csv(universe, "F:/GeoMX KPC/Cheng_WTA1/processed_data/DEG_universe.csv")
seurat <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list seurat.xlsx", sheet = "PV_glands_seurat")
mmnDE <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list mixedmodelDE.xlsx", sheet = "PV_glands")
universe <- read.csv("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/DEG_universe.csv")
universe <- dplyr::select(universe,SYMBOL,ENTREZID)
head(universe)
mmDE <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list mixedmodelDE.xlsx", sheet = "PV_glands")
gene_list <- list(mmDE = mmDE$Gene,
seurat = seurat$Gene)
VennDiagram <- venn.diagram(x = gene_list,
fill = c("blue", "red", "green"),
cat.col = c("blue", "red", "green"),
cex = 2,lty = "blank",
cat.cex = 2,
filename = NULL)
cowplot::plot_grid(VennDiagram)
VennDiagram <- venn.diagram(x = gene_list,
fill = c("blue", "red"),
cat.col = c("blue", "red"),
cex = 2,lty = "blank",
cat.cex = 2,
filename = NULL)
cowplot::plot_grid(VennDiagram)
seurat <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list seurat.xlsx", sheet = "PV_glands_seurat")
mmDE <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list mixedmodelDE.xlsx", sheet = "PV_glands")
PV_glands <- dplyr::left_join(seurat, mmDE, by = Gene)
PV_glands <- dplyr::left_join(seurat, mmDE, by = "Gene")
View(PV_glands)
PV_glands <- dplyr::full_join(seurat, mmDE, by = "Gene")
View(PV_glands)
PV_glands <- dplyr::full_join(seurat, mmDE, by = "Gene")
write.csv(PV_glands, "C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/FULL_PV_glands.csv")
PV_glands1 <- distinct(PV_glands, Gene, .keep_all = T)
View(PV_glands1)
PV_glands <- dplyr::full_join(seurat, mmDE, by = "Gene")
PV_glands <- distinct(PV_glands, Gene, .keep_all = T)
write.csv(PV_glands, "C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/FULL_PV_glands.csv")
seurat <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list seurat.xlsx", sheet = "PV_glands_seurat")
mmDE <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list mixedmodelDE.xlsx", sheet = "PV_glands")
PV_glands <- dplyr::full_join(seurat, mmDE, by = "Gene")
PV_glands <- distinct(PV_glands, Gene, .keep_all = T)
write.csv(PV_glands, "C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/FULL_PV_glands.csv")
seurat <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list seurat.xlsx", sheet = "N_glands_seurat")
mmDE <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list mixedmodelDE.xlsx", sheet = "N_glands")
N_glands <- dplyr::full_join(seurat, mmDE, by = "Gene")
N_glands <- distinct(PV_glands, Gene, .keep_all = T)
write.csv(PV_glands, "C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/FULL_N_glands.csv")
rm(seurat, mmDE)
seurat <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list seurat.xlsx", sheet = "PV_glands_seurat")
mmDE <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list mixedmodelDE.xlsx", sheet = "PV_glands")
PV_glands <- dplyr::full_join(seurat, mmDE, by = "Gene")
PV_glands <- distinct(PV_glands, Gene, .keep_all = T)
write.csv(PV_glands, "C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/FULL_PV_glands.csv")
rm(seurat, mmDE)
seurat <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list seurat.xlsx", sheet = "N_glands_seurat")
mmDE <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list mixedmodelDE.xlsx", sheet = "N_glands")
N_glands <- dplyr::full_join(seurat, mmDE, by = "Gene")
N_glands <- distinct(N_glands, Gene, .keep_all = T)
write.csv(N_glands, "C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/FULL_N_glands.csv")
rm(seurat, mmDE)
seurat <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list seurat.xlsx", sheet = "PV_mucosa_seurat")
mmDE <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list mixedmodelDE.xlsx", sheet = "PV_mucosa")
PV_mucosa <- dplyr::full_join(seurat, mmDE, by = "Gene")
PV_mucosa <- distinct(PV_mucosa, Gene, .keep_all = T)
write.csv(PV_mucosa, "C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/FULL_PV_mucosa.csv")
rm(seurat, mmDE)
seurat <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list seurat.xlsx", sheet = "N_mucosa_seurat")
mmDE <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list mixedmodelDE.xlsx", sheet = "N_mucosa")
N_mucosa <- dplyr::full_join(seurat, mmDE, by = "Gene")
N_mucosa <- distinct(N_mucosa, Gene, .keep_all = T)
write.csv(PV_glands, "C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/FULL_N_mucosa.csv")
rm(seurat, mmDE)
seurat <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list seurat.xlsx", sheet = "PV_stroma_seurat")
mmDE <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list mixedmodelDE.xlsx", sheet = "PV_stroma")
PV_stroma <- dplyr::full_join(seurat, mmDE, by = "Gene")
PV_stroma <- distinct(PV_stroma, Gene, .keep_all = T)
write.csv(PV_glands, "C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/FULL_PV_stroma.csv")
rm(seurat, mmDE)
seurat <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list seurat.xlsx", sheet = "N_stroma_seurat")
mmDE <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list mixedmodelDE.xlsx", sheet = "N_stroma")
N_stroma <- dplyr::full_join(seurat, mmDE, by = "Gene")
N_stroma <- distinct(N_stroma, Gene, .keep_all = T)
write.csv(N_stroma, "C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/FULL_N_stroma.csv")
gene_list <- list(PV_glands = PV_glands$Gene,
N_glands = seurat$Gene,
PV_mucosa = PV_mucosa$Gene,
N_mucosa = N_mucosa$Gene,
PV_stroma = PV_stroma$Gene,
N_stroma= N_stroma$Gene)
VennDiagram <- venn.diagram(x = gene_list,
#fill = c("blue", "red"),
#cat.col = c("blue", "red"),
cex = 2,lty = "blank",
cat.cex = 2,
filename = NULL)
cowplot::plot_grid(VennDiagram)
VennDiagram <- venn.diagram(x = gene_list)
VennDiagram <- venn.diagram(x = gene_list, filename = NULL)
gene_list <- list(PV_glands = PV_glands$Gene,
N_glands = seurat$Gene,
PV_mucosa = PV_mucosa$Gene,
N_mucosa = N_mucosa$Gene)#,
VennDiagram <- venn.diagram(x = gene_list, filename = NULL)
cowplot::plot_grid(VennDiagram)
VennDiagram <- venn.diagram(x = gene_list, filename = NULL,
fill = c("blue", "red", "green", "yellow"),
cat.col = c("blue", "red", "green", "yellow"),
cex = 2,lty = "blank",
cat.cex = 2)
cowplot::plot_grid(VennDiagram)
seurat <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list seurat.xlsx", sheet = "PV_stroma_seurat")
mmDE <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list mixedmodelDE.xlsx", sheet = "PV_stroma")
PV_stroma <- dplyr::full_join(seurat, mmDE, by = "Gene")
PV_stroma <- distinct(PV_stroma, Gene, .keep_all = T)
write.csv(PV_stroma, "C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/FULL_PV_stroma.csv")
seurat <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list seurat.xlsx", sheet = "PV_stroma_seurat")
mmDE <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list mixedmodelDE.xlsx", sheet = "PV_stroma")
PV_stroma <- dplyr::full_join(seurat, mmDE, by = "Gene")
PV_stroma <- distinct(PV_stroma, Gene, .keep_all = T)
write.csv(PV_stroma, "C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/FULL_PV_stroma.csv")
seurat <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list seurat.xlsx", sheet = "N_mucosa_seurat")
mmDE <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list mixedmodelDE.xlsx", sheet = "N_mucosa")
N_mucosa <- dplyr::full_join(seurat, mmDE, by = "Gene")
N_mucosa <- distinct(N_mucosa, Gene, .keep_all = T)
write.csv(N_mucosa, "C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/FULL_N_mucosa.csv")
seurat <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list seurat.xlsx", sheet = "PV_glands_seurat")
mmDE <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list mixedmodelDE.xlsx", sheet = "PV_glands")
PV_glands <- dplyr::full_join(seurat, mmDE, by = "Gene")
PV_glands <- distinct(PV_glands, Gene, .keep_all = T)
write.csv(PV_glands, "C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/FULL_PV_glands.csv")
rm(seurat, mmDE)
seurat <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list seurat.xlsx", sheet = "N_glands_seurat")
mmDE <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list mixedmodelDE.xlsx", sheet = "N_glands")
N_glands <- dplyr::full_join(seurat, mmDE, by = "Gene")
N_glands <- distinct(N_glands, Gene, .keep_all = T)
write.csv(N_glands, "C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/FULL_N_glands.csv")
rm(seurat, mmDE)
seurat <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list seurat.xlsx", sheet = "PV_mucosa_seurat")
mmDE <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list mixedmodelDE.xlsx", sheet = "PV_mucosa")
PV_mucosa <- dplyr::full_join(seurat, mmDE, by = "Gene")
PV_mucosa <- distinct(PV_mucosa, Gene, .keep_all = T)
write.csv(PV_mucosa, "C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/FULL_PV_mucosa.csv")
rm(seurat, mmDE)
seurat <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list seurat.xlsx", sheet = "N_mucosa_seurat")
mmDE <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list mixedmodelDE.xlsx", sheet = "N_mucosa")
N_mucosa <- dplyr::full_join(seurat, mmDE, by = "Gene")
N_mucosa <- distinct(N_mucosa, Gene, .keep_all = T)
write.csv(N_mucosa, "C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/FULL_N_mucosa.csv")
rm(seurat, mmDE)
seurat <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list seurat.xlsx", sheet = "PV_stroma_seurat")
mmDE <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list mixedmodelDE.xlsx", sheet = "PV_stroma")
PV_stroma <- dplyr::full_join(seurat, mmDE, by = "Gene")
PV_stroma <- distinct(PV_stroma, Gene, .keep_all = T)
write.csv(PV_stroma, "C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/FULL_PV_stroma.csv")
rm(seurat, mmDE)
seurat <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list seurat.xlsx", sheet = "N_stroma_seurat")
mmDE <- read_excel("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/Cheng DEG list mixedmodelDE.xlsx", sheet = "N_stroma")
N_stroma <- dplyr::full_join(seurat, mmDE, by = "Gene")
N_stroma <- distinct(N_stroma, Gene, .keep_all = T)
write.csv(N_stroma, "C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/FULL_N_stroma.csv")
gene_list <- list(PV_glands = PV_glands$Gene,
N_glands = seurat$Gene,
PV_mucosa = PV_mucosa$Gene,
N_mucosa = N_mucosa$Gene)
VennDiagram <- venn.diagram(x = gene_list, filename = NULL,
fill = c("blue", "red", "green", "yellow"),
cat.col = c("blue", "red", "green", "yellow"),
cex = 2,lty = "blank",
cat.cex = 2)
cowplot::plot_grid(VennDiagram)
View(VennDiagram)
View(gene_list)
gene_list <- list(PV_stroma = PV_stroma$Gene,
N_stroma = N_stroma$Gene)
VennDiagram <- venn.diagram(x = gene_list, filename = NULL,
fill = c("blue", "red", "green", "yellow"),
cat.col = c("blue", "red", "green", "yellow"),
cex = 2,lty = "blank",
cat.cex = 2)
cowplot::plot_grid(VennDiagram)
VennDiagram <- venn.diagram(x = gene_list, filename = NULL,
fill = c("blue", "red"),
cat.col = c("blue", "red"),
cex = 2,lty = "blank",
cat.cex = 2)
cowplot::plot_grid(VennDiagram)
results <- PV_glands
head(results)
names(results)[2]
names(results)[6]
names(results)[1] <- 'SYMBOL'
head(results)
eg <- bitr(results$SYMBOL, fromType="SYMBOL", toType=c("ENTREZID"), OrgDb="org.Mm.eg.db")
results <- dplyr::left_join(results, eg, by = "SYMBOL")
rm(eg)
universe <- read.csv("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/DEG_universe.csv")
universe <- dplyr::select(universe,SYMBOL,ENTREZID)
head(universe)
universe <- distinct(results, SYMBOL, .keep_all = T)
universe <- read.csv("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/DEG_universe.csv")
universe <- dplyr::select(universe,SYMBOL,ENTREZID)
head(universe)
universe <- distinct(results, SYMBOL, .keep_all = T)
head(universe)
universe <- read.csv("C:/Users/edmondsonef/Desktop/ChengS_DSP Results/DEG/DEG_universe.csv")
universe <- dplyr::select(universe,SYMBOL,ENTREZID)
head(universe)
universe <- distinct(universe, SYMBOL, .keep_all = T)
head(universe)
resultsGO <- dplyr::filter(results, abs(results$Estimate) > 0.5 & results$FDR < 0.05)
summary(resultsGO)
gene <- resultsGO
head(gene)
ego <- enrichGO(gene          = gene$ENTREZID,
keyType       = "ENTREZID",
universe      = universe$ENTREZID, ##list of all genes??
OrgDb         = org.Mm.eg.db,
ont           = "BP", #"BP", "MF", and "CC"
pAdjustMethod = "BH",
pvalueCutoff  = 0.01,
qvalueCutoff  = 0.05,
readable      = TRUE)
head(ego)
p1 <- dotplot(ego, showCategory=30) + ggtitle("dotplot for ORA")
p1
library(knitr)
library(dplyr)
library(ggforce)
library(GeoMxWorkflows)
library(NanoStringNCTools)
library(GeomxTools)
library(readxl)
library(enrichplot)
library(data.table)
library(fgsea)
library(ggplot2)
library(ggrepel)
library(org.Hs.eg.db)
library(org.Mm.eg.db)
library(AnnotationHub)
library(GOSemSim)
library(clusterProfiler)
library(GOSemSim)
library(ggplot2)
library(cowplot)
library(ReactomePA)
library(DOSE)
library(msigdbr)
p1
p1 <- dotplot(ego, showCategory=30) + ggtitle("dotplot for ORA")
p1
gene <- distinct(results, SYMBOL, .keep_all = T)
head(gene)
dotplot(ego)
head(ego)
ego
View(ego)
gene <- results
head(gene)
ego <- enrichGO(gene          = gene$ENTREZID,
keyType       = "ENTREZID",
universe      = universe$ENTREZID, ##list of all genes??
OrgDb         = org.Mm.eg.db,
ont           = "BP", #"BP", "MF", and "CC"
pAdjustMethod = "BH",
pvalueCutoff  = 0.01,
qvalueCutoff  = 0.05,
readable      = TRUE)
universe$ENTREZID
gene$ENTREZID
head(ego)
dotplot(ego)
p1 <- dotplot(ego, showCategory=30) + ggtitle("dotplot for ORA")
p1
library(knitr)
library(dplyr)
library(ggforce)
library(GeoMxWorkflows)
library(NanoStringNCTools)
library(GeomxTools)
library(readxl)
library(enrichplot)
library(data.table)
library(fgsea)
library(ggplot2)
library(ggrepel)
library(org.Hs.eg.db)
library(org.Mm.eg.db)
library(AnnotationHub)
library(GOSemSim)
library(clusterProfiler)
library(GOSemSim)
library(ggplot2)
library(cowplot)
library(ReactomePA)
library(DOSE)
library(msigdbr)
head(universe)
universe <- distinct(universe, SYMBOL, .keep_all = T)
head(universe)
gene <- results
head(gene)
ego <- enrichGO(gene          = gene$ENTREZID,
keyType       = "ENTREZID",
universe      = universe$ENTREZID, ##list of all genes??
OrgDb         = org.Mm.eg.db,
ont           = "BP", #"BP", "MF", and "CC"
pAdjustMethod = "BH",
pvalueCutoff  = 0.01,
qvalueCutoff  = 0.05,
readable      = TRUE)
library(readxl)
save <- read_excel("C:/Users/edmondsonef/Desktop/save.xlsx")
save1 <- distinct(save, request, .keep_all = T)
library(knitr)
library(dplyr)
library(ggforce)
library(GeoMxWorkflows)
library(NanoStringNCTools)
library(GeomxTools)
library(readxl)
library(enrichplot)
library(data.table)
library(fgsea)
library(ggplot2)
library(ggrepel)
library(org.Hs.eg.db)
library(org.Mm.eg.db)
library(AnnotationHub)
library(GOSemSim)
library(clusterProfiler)
library(GOSemSim)
library(ggplot2)
library(cowplot)
library(ReactomePA)
library(DOSE)
library(msigdbr)
library(readxl)
save1 <- distinct(save, request, .keep_all = T)
head(save1)
write.csv(save1, "C:/Users/edmondsonef/Desktop/save1.csv")
library(gridExtra)
library(readxl)
library(ggpubr)
library(Rmisc)
library(tidyverse)
library(plyr)
library(GGally)
library(ggplot2)
library(tidyverse)
library(gapminder)
library(dplyr)
library(ggsignif)
library(readxl)
QTLgene <- read_excel("C:/Users/edmondsonef/Desktop/Cataract QTL manuscript/Table 1 QTL.xlsx",
sheet = "QTL_geneList")
QTLgene <- read_excel("C:/Users/edmondsonef/Desktop/Cataract QTL manuscript/Table 1 QTL.xlsx",
sheet = "QTL_geneList")
iSyTE <- read_excel("C:/Users/edmondsonef/Desktop/Cataract QTL manuscript/Table 1 QTL.xlsx",
sheet = "iSyTE")
QTLgene <- read_excel("C:/Users/edmondsonef/Desktop/Cataract QTL manuscript/Table 1 QTL.xlsx",
sheet = "QTL_geneList")
iSyTE <- read_excel("C:/Users/edmondsonef/Desktop/Cataract QTL manuscript/Table 1 QTL.xlsx",
sheet = "iSyTE")
new <- dplyr::left_join(QTLgene, iSyTE, by = "Symbol")
View(new)
new <- dplyr::inner_join(QTLgene, iSyTE, by = "Symbol")
View(new)
QTLgene <- read_excel("C:/Users/edmondsonef/Desktop/Cataract QTL manuscript/Table 1 QTL.xlsx",
sheet = "QTL_geneList")
iSyTE <- read_excel("C:/Users/edmondsonef/Desktop/Cataract QTL manuscript/Table 1 QTL.xlsx",
sheet = "iSyTE")
QTLgene <- read_excel("C:/Users/edmondsonef/Desktop/Cataract QTL manuscript/Table 1 QTL.xlsx",
sheet = "QTL_geneList")
iSyTE <- read_excel("C:/Users/edmondsonef/Desktop/Cataract QTL manuscript/Table 1 QTL.xlsx",
sheet = "iSyTE")
new <- dplyr::inner_join(QTLgene, iSyTE, by = "Symbol")
write.csv(new,"C:/Users/edmondsonef/Desktop/new.csv")
QTLgene <- read_excel("C:/Users/edmondsonef/Desktop/Cataract QTL manuscript/Table 1 QTL.xlsx",
sheet = "QTL_geneList")
iSyTE <- read_excel("C:/Users/edmondsonef/Desktop/Cataract QTL manuscript/Table 1 QTL.xlsx",
sheet = "iSyTE")
new <- dplyr::inner_join(QTLgene, iSyTE, by = "Symbol")
write.csv(new,"C:/Users/edmondsonef/Desktop/new.csv")
QTLgene <- read_excel("C:/Users/edmondsonef/Desktop/Cataract QTL manuscript/Table 1 QTL.xlsx",
sheet = "QTL_geneList")
iSyTE <- read_excel("C:/Users/edmondsonef/Desktop/Cataract QTL manuscript/Table 1 QTL.xlsx",
sheet = "iSyTE")
new <- dplyr::inner_join(QTLgene, iSyTE, by = "Symbol")
write.csv(new,"C:/Users/edmondsonef/Desktop/new.csv")
QTLgene <- read_excel("C:/Users/edmondsonef/Desktop/Cataract QTL manuscript/Table 1 QTL.xlsx",
sheet = "QTL_geneList")
iSyTE <- read_excel("C:/Users/edmondsonef/Desktop/Cataract QTL manuscript/Table 1 QTL.xlsx",
sheet = "iSyTE")
new <- dplyr::inner_join(QTLgene, iSyTE, by = "Symbol")
write.csv(new,"C:/Users/edmondsonef/Desktop/new.csv")
library(readxl)
data <- read_excel("C:/Users/edmondsonef/Desktop/MHL 22-262-8 Nellan.xlsx",
sheet = "Sheet2")
New <- data %>% group_by(`Image Tag`, `Layer Name`) %>% summarise(avg = mean(`Area (microns squared)`),
sum = sum(`Area (microns squared)`))
library(gridExtra)
library(readxl)
library(ggpubr)
library(Rmisc)
library(tidyverse)
library(plyr)
library(GGally)
library(ggplot2)
library(tidyverse)
library(gapminder)
library(dplyr)
library(ggsignif)
New <- data %>% group_by(`Image Tag`, `Layer Name`) %>% summarise(avg = mean(`Area (microns squared)`),
sum = sum(`Area (microns squared)`))
new <- data %>% group_by(`Image Tag`, `Layer Name`) %>% summarise(sum = sum(`Area (microns squared)`))
write.csv(new, "C:/Users/edmondsonef/Desktop/new.csv")
