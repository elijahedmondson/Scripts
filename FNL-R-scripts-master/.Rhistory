x <- c(9.1, 8.5, 7.1, 6.2, 5, 9.5, 5, 7.8, 9.5, 9.1, 8.5, 7.1, 6.2, 5, 9.5, 5,
7.8, 9.5, 9.1, 8.5, 7.1, 6.2, 5, 9.5, 5, 7.8, 9.5,9.1, 8.5, 7.1, 6.2,
5, 9.5, 5, 7.8, 9.5, 7.8, 7.7, 8,8,8,8,8,8,7,7,7,7,7,7,7,7,9.1, 8.5,
7.1, 6.2, 5, 9.5, 5, 7.8, 9.5, 9.1, 8.5, 7.1, 6.2, 5, 9.5, 5,
7.8, 9.5, 9.1, 8.5, 7.1, 6.2, 5, 9.5, 5, 7.8, 9.5,9.1, 8.5, 7.1, 6.2,
5, 9.5, 5, 7.8, 9.5, 7.8, 7.7, 8,8,8,8,8,8,7,7,7,7,7,7,7,7,9.1, 8.5,
7.1, 6.2, 5, 9.5, 5, 7.8, 9.5, 9.1, 8.5, 7.1, 6.2, 5, 9.5, 5,
7.8, 9.5, 9.1, 8.5, 7.1, 6.2, 5, 9.5, 5, 7.8, 9.5,9.1, 8.5, 7.1, 6.2,
5, 9.5, 5, 7.8, 9.5, 7.8, 7.7, 8,8,8,8,8,8,7,7,7,7,7,7,7,7,9.1, 8.5,
7.1, 6.2, 5, 9.5, 5, 7.8, 9.5, 9.1, 8.5, 7.1, 6.2, 5, 9.5, 5,
7.8, 9.5, 9.1, 8.5, 7.1, 6.2, 5, 9.5, 5, 7.8, 9.5,9.1, 8.5, 7.1, 6.2,
5, 9.5, 5, 7.8, 9.5, 7.8, 7.7, 8,8,8,8,8,8,7,7,7,7,7,7,7,7,9.1, 8.5,
7.1, 6.2, 5, 9.5, 5, 7.8, 9.5, 9.1, 8.5, 7.1, 6.2, 5, 9.5, 5,
7.8, 9.5, 9.1, 8.5, 7.1, 6.2, 5, 9.5, 5, 7.8, 9.5,9.1, 8.5, 7.1, 6.2,
5, 9.5, 5, 7.8, 9.5, 7.8, 7.7, 8,8,8,8,8,8,7,7,7,7,7,7,7,7,9.9)
thr1 = quantile(x,  probs = 0.190)
thr2 = quantile(x,  probs = 0.95)
thr3 = quantile(x,  probs = 0.99999)
library(readxl)
library(tidyverse)
library(DescTools)
library(lme4)
library(broom.mixed)
library(kableExtra)
library(xtable)
library(emmeans)
library(ggsci)
library(sjPlot)
library(coda)
library(rjags)
library(R2jags)
library(superdiag)
library(mcmcplots)
library(ggmcmc)
library(gridExtra)
library(plyr)
library(forcats)
data <- read_excel("C:/Users/edmondsonef/Desktop/CATARACT_final.xlsx")
data <- read_excel("C:/Users/edmondsonef/Desktop/Cataract/CATARACT_final.xlsx")
ggplot(data, aes(x = data$'SUM1', y = data$'SUM2')) +
geom_point(aes(color = data$sex), size = 3)+
scale_y_continuous(name = "SUM2") +
scale_x_continuous(name = "SUM1") +
theme_bw(base_size = 18)+
stat_smooth(method = "lm",
col = "#C42126",
se = T,
size = 1)
ggplot(data, aes(x = data$'SUM1', y = data$'SUM2')) +
geom_point(aes(color = data$sex), size = 3)+
scale_y_continuous(name = "OD Score") +
scale_x_continuous(name = "OS Score") +
theme_bw(base_size = 18)+
stat_smooth(method = "lm",
col = "#C42126",
se = T,
size = 1)
ggplot(data, aes(x = data$'SUM1', y = data$'SUM2')) +
geom_point(aes(color = data$family), size = 3)+
scale_y_continuous(name = "OD Score") +
scale_x_continuous(name = "OS Score") +
theme_bw(base_size = 18)+
stat_smooth(method = "lm",
col = "#C42126",
se = T,
size = 1)
data$families <-  as.character(data$family)
ggplot(data, aes(x = data$'SUM1', y = data$'SUM2')) +
geom_point(aes(color = data$familes), size = 3)+
scale_y_continuous(name = "OD Score") +
scale_x_continuous(name = "OS Score") +
theme_bw(base_size = 18)+
stat_smooth(method = "lm",
col = "#C42126",
se = T,
size = 1)
data$familes
data$families <-  as.character(data$family)
# Plot specific SDP locations along a chromosome.
# This idea is from Yalcin et.al., Genetics, 2005.
# results: the data.frame output from merge.analysis().
# ...: additional arguments to pass to plot.
sdp.plot = function(results, ...) {
if(is.null(results) || nrow(results) == 0) {
warning("sdp.plot: No SNPs to plot.")
return()
} # if(is.null(results) || nrow(results) == 0)
sdps = results[!duplicated(results[,3]),]
call = match.call()
if("xlim" %in% names(call)) {
plot(-1, -1, col = 0, ylim = c(0, 8), yaxs = "i", ann = FALSE,
axes = FALSE, ...)
} else {
plot(-1, -1, col = 0, xlim = range(results[,2]), ylim = c(0, 8),
yaxs = "i", ann = FALSE, axes = FALSE, ...)
} # else
abline(h = 0:8)
box()
mtext(side = 2, at = 8:1 - 0.5, text = do.colors[,1],
line = 0.3, adj = 1, las = 2)
# Don't plot the axis if the user specifies xaxt = "n".
if("xaxt" %in% names(call)) {
xaxt = eval(call$xaxt, envir = parent.frame())
if(xaxt != "n") {
ax = axis(side = 1, labels = FALSE)
axis(side = 1, at = ax, labels = ax)
} # if(xaxt != "n")
} else {
ax = axis(side = 1, labels = FALSE)
axis(side = 1, at = ax, labels = ax)
} # else
# Find the SDPs in the results.
wh = which(colSums(results[,-c(1:3,12)]) > 0)
for(i in wh) {
m = results[which(results[,3+i] == 1),2]
y = matrix(rep((9-i):(8-i), length(m)), nrow = 2)
y = rbind(y, rep(NA, ncol(y)))
y = as.vector(y)
x = matrix(rep(m, each = 2), nrow = 2)
x = rbind(x, rep(NA, ncol(x)))
x = as.vector(x)
lines(x, y, col = "grey40")
} # for(i)
abline(h = 0:8)
} # sdp.plot()
data$familes
ggplot(data, aes(x = data$'SUM1', y = data$'SUM2')) +
geom_point(aes(color = data$families), size = 3)+
scale_y_continuous(name = "OD Score") +
scale_x_continuous(name = "OS Score") +
theme_bw(base_size = 18)+
stat_smooth(method = "lm",
col = "#C42126",
se = T,
size = 1)
data$families <-  as.character(data$family == c(6, 36, 50, 47, 20, 34))
ggplot(data, aes(x = data$'SUM1', y = data$'SUM2')) +
geom_point(aes(color = data$families), size = 3)+
scale_y_continuous(name = "OD Score") +
scale_x_continuous(name = "OS Score") +
theme_bw(base_size = 18)+
stat_smooth(method = "lm",
col = "#C42126",
se = T,
size = 1)
data$families <-  as.numeric(data$family == c(6, 36, 50, 47, 20, 34))
ggplot(data, aes(x = data$'SUM1', y = data$'SUM2')) +
geom_point(aes(color = data$families), size = 3)+
scale_y_continuous(name = "OD Score") +
scale_x_continuous(name = "OS Score") +
theme_bw(base_size = 18)+
stat_smooth(method = "lm",
col = "#C42126",
se = T,
size = 1)
ggplot(data, aes(x = data$'SUM1', y = data$'SUM2')) +
geom_point(aes(color = data$families), size = 3)+
gghighlight(N > 200,  label_key = families) +
scale_y_continuous(name = "OD Score") +
scale_x_continuous(name = "OS Score") +
theme_bw(base_size = 18)+
stat_smooth(method = "lm",
col = "#C42126",
se = T,
size = 1)
install.packages("gghighlight")
library(gghighlight)
library(gghighlight)
ggplot(data, aes(x = data$'SUM1', y = data$'SUM2')) +
geom_point(aes(color = data$families), size = 3)+
gghighlight(N > 200,  label_key = families) +
scale_y_continuous(name = "OD Score") +
scale_x_continuous(name = "OS Score") +
theme_bw(base_size = 18)+
stat_smooth(method = "lm",
col = "#C42126",
se = T,
size = 1)
ggplot(data, aes(x = data$'SUM1', y = data$'SUM2')) +
geom_point(aes(color = data$families), size = 3)+
gghighlight(N > 100,  label_key = family) +
scale_y_continuous(name = "OD Score") +
scale_x_continuous(name = "OS Score") +
theme_bw(base_size = 18)+
stat_smooth(method = "lm",
col = "#C42126",
se = T,
size = 1)
ggplot(data, aes(x = data$'SUM1', y = data$'SUM2')) +
geom_point(aes(color = data$families), size = 3)+
gghighlight(SUM2 > 10,  label_key = family) +
scale_y_continuous(name = "OD Score") +
scale_x_continuous(name = "OS Score") +
theme_bw(base_size = 18)+
stat_smooth(method = "lm",
col = "#C42126",
se = T,
size = 1)
ggplot(data, aes(x = data$'SUM1', y = data$'SUM2')) +
geom_point(aes(color = data$families), size = 3)+
gghighlight(SUM1 > 10,  label_key = family) +
scale_y_continuous(name = "OD Score") +
scale_x_continuous(name = "OS Score") +
theme_bw(base_size = 18)+
stat_smooth(method = "lm",
col = "#C42126",
se = T,
size = 1)
ggplot(data, aes(x = SUM1, y = SUM2)) +
geom_point(aes(color = data$families), size = 3)+
gghighlight(SUM1 > 10,  label_key = family) +
scale_y_continuous(name = "OD Score") +
scale_x_continuous(name = "OS Score") +
theme_bw(base_size = 18)+
stat_smooth(method = "lm",
col = "#C42126",
se = T,
size = 1)
ggplot(data, aes(x = SUM1, y = SUM2)) +
geom_point(aes(color = data$family), size = 3)+
gghighlight(SUM1 > 10,  label_key = family) +
scale_y_continuous(name = "OD Score") +
scale_x_continuous(name = "OS Score") +
theme_bw(base_size = 18)+
stat_smooth(method = "lm",
col = "#C42126",
se = T,
size = 1)
ggplot(data, aes(x = SUM1, y = SUM2)) +
geom_point(aes(color = data$family), size = 3)+
gghighlight(SUM1 > 5,  label_key = family) +
scale_y_continuous(name = "OD Score") +
scale_x_continuous(name = "OS Score") +
theme_bw(base_size = 18)+
stat_smooth(method = "lm",
col = "#C42126",
se = T,
size = 1)
highlight_df <- data %>% filter(SUM1>=10)
ggplot(data, aes(x = SUM1, y = SUM2)) +
geom_point(aes(color = data$family), size = 3)+
scale_y_continuous(name = "OD Score") +
scale_x_continuous(name = "OS Score") +
theme_bw(base_size = 18)+
geom_point(data=highlight_df,
aes(x=SUM1,y=SUM2),
color='red',
size=3)
highlight_df <- data %>% filter(data$family == c(6, 36, 50, 47, 20, 34))
ggplot(data, aes(x = SUM1, y = SUM2)) +
geom_point(aes(color = data$family), size = 3)+
scale_y_continuous(name = "OD Score") +
scale_x_continuous(name = "OS Score") +
theme_bw(base_size = 18)+
geom_point(data=highlight_df,
aes(x=SUM1,y=SUM2),
color='red',
size=3)
ggplot(data, aes(x = SUM1, y = SUM2)) +
geom_point(size = 3)+
scale_y_continuous(name = "OD Score") +
scale_x_continuous(name = "OS Score") +
theme_bw(base_size = 18)+
geom_point(data=highlight_df,
aes(x=SUM1,y=SUM2),
color=family,
size=3)
ggplot(data, aes(x = SUM1, y = SUM2)) +
geom_point(size = 3)+
scale_y_continuous(name = "OD Score") +
scale_x_continuous(name = "OS Score") +
theme_bw(base_size = 18)+
geom_point(data=highlight_df,
aes(x=SUM1,y=SUM2),
color=family,
size=3) +
stat_smooth(method = "lm",
col = "#C42126",
se = T,
size = 1)
ggplot(data, aes(x = SUM1, y = SUM2)) +
geom_point(size = 3)+
scale_y_continuous(name = "OD Score") +
scale_x_continuous(name = "OS Score") +
theme_bw(base_size = 18)+
geom_point(data=highlight_df,
aes(x=SUM1,y=SUM2),
color=family,
size=3) +
stat_smooth(method = "lm",
col = "#C42126",
se = T,
size = 1)
ggplot(data, aes(x = SUM1, y = SUM2)) +
geom_point(size = 3)+
scale_y_continuous(name = "OD Score") +
scale_x_continuous(name = "OS Score") +
theme_bw(base_size = 18)+
geom_point(data=highlight_df, aes(x=SUM1,y=SUM2, color=family), size=3) +
stat_smooth(method = "lm",
col = "#C42126",
se = T,
size = 1)
data$families <-  as.character(data$family)
highlight_df <- data %>% filter(data$family == c(6, 36, 50, 47, 20, 34))
ggplot(data, aes(x = SUM1, y = SUM2)) +
geom_point(size = 3)+
scale_y_continuous(name = "OD Score") +
scale_x_continuous(name = "OS Score") +
theme_bw(base_size = 18)+
geom_point(data=highlight_df, aes(x=SUM1,y=SUM2, color=family), size=3) +
stat_smooth(method = "lm",
col = "#C42126",
se = T,
size = 1)
ggplot(data, aes(x = SUM1, y = SUM2)) +
geom_point(size = 3)+
scale_y_continuous(name = "OD Score") +
scale_x_continuous(name = "OS Score") +
theme_bw(base_size = 18)+
geom_point(data=highlight_df, aes(x=SUM1,y=SUM2, color=families), size=3) +
stat_smooth(method = "lm",
col = "#C42126",
se = T,
size = 1)
ggplot(data, aes(x=cat_score, color=family)) +
geom_histogram(fill="white", position="dodge")+
theme(legend.position="top")+
geom_histogram(position="identity", alpha=0.25, bins =600)+
geom_vline(data=mu, aes(xintercept=grp.mean, color=family),
linetype="dashed")
data %>%
mutate(family = fct_reorder(families, family)) %>%
ggplot(aes(x = family, y = cat_score, fill = family)) +
geom_boxplot() +
stat_summary(fun = "mean", geom = "point", shape = 8, size = 2, color = "white")+
theme_bw() +
theme(legend.position = "none")
###Cataract Analysis
library(readxl)
library(survival)
library(survminer)
library(mgcv)
library(readxl)
data <- read_excel("C:/Users/edmondsonef/Desktop/Cataract/CATARACT_final.xlsx",
sheet = "KM")
View(data)
fit <- survfit(Surv(data$Score0.5day, data$Socre0.5) ~ data$Sex, data = data)
# Visualize with survminer
ggsurvplot(fit, data = data, risk.table = TRUE, conf.int = T, pval= T)
fit <- survfit(Surv(data$Score0.5day, data$Socre0.5) ~ data$sex, data = data)
# Visualize with survminer
ggsurvplot(fit, data = data, risk.table = TRUE, conf.int = T, pval= T)
fit <- survfit(Surv(data$Score0.5day, data$Socre0.5) ~ data$groups, data = data)
# Visualize with survminer
ggsurvplot(fit, data = data, risk.table = TRUE, conf.int = T, pval= T)
fit <- survfit(Surv(data$Score1.0day, data$Score1.0) ~ data$groups, data = data)
# Visualize with survminer
ggsurvplot(fit, data = data, risk.table = TRUE, conf.int = T, pval= T)
fit <- survfit(Surv(data$Score2.0day, data$Score2.0) ~ data$groups, data = data)
# Visualize with survminer
ggsurvplot(fit, data = data, risk.table = TRUE, conf.int = T, pval= T)
fit <- survfit(Surv(data$Score1.5day, data$Score1.5) ~ data$groups, data = data)
# Visualize with survminer
ggsurvplot(fit, data = data, risk.table = TRUE, conf.int = T, pval= T)
fit <- survfit(Surv(data$Score2.5day, data$Score2.5) ~ data$groups, data = data)
# Visualize with survminer
ggsurvplot(fit, data = data, risk.table = TRUE, conf.int = T, pval= T)
fit <- survfit(Surv(data$Score3.0day, data$Score3.0) ~ data$groups, data = data)
# Visualize with survminer
ggsurvplot(fit, data = data, risk.table = TRUE, conf.int = T, pval= T)
fit <- survfit(Surv(data$Score3.0day, data$Score3.0) ~ data$groups, data = data)
fit <- survfit(Surv(data$Cat3.0day, data$Cate3.0) ~ data$groups, data = data)
# Visualize with survminer
ggsurvplot(fit, data = data, risk.table = TRUE, conf.int = T, pval= T)
fit <- survfit(Surv(data$Cat3.0day, data$Cat3.0) ~ data$groups, data = data)
# Visualize with survminer
ggsurvplot(fit, data = data, risk.table = TRUE, conf.int = T, pval= T)
fit <- survfit(Surv(data$Cat3.5day, data$Cat3.5) ~ data$groups, data = data)
# Visualize with survminer
ggsurvplot(fit, data = data, risk.table = TRUE, conf.int = T, pval= T)
fit <- survfit(Surv(data$Cat4.0day, data$Cat4.0) ~ data$groups, data = data)
# Visualize with survminer
ggsurvplot(fit, data = data, risk.table = TRUE, conf.int = T, pval= T)
data <- read_excel("C:/Users/edmondsonef/Desktop/Cataract/CATARACT_final.xlsx")
data %>%
mutate(family = fct_reorder(families, family)) %>%
ggplot(aes(x = family, y = cat_score, fill = family)) +
geom_boxplot() +
stat_summary(fun = "mean", geom = "point", shape = 8, size = 2, color = "white")+
theme_bw() +
theme(legend.position = "none")
ggplot(data, aes(x=cat_score, color=family)) +
geom_histogram(fill="white", position="dodge")+
theme(legend.position="top")+
geom_histogram(position="identity", alpha=0.25, bins =600)+
geom_vline(data=mu, aes(xintercept=grp.mean, color=family),
linetype="dashed")
ggplot(data, aes(x=cat_score, color=family)) +
geom_histogram(fill="white", position="dodge")+
theme(legend.position="top")+
geom_histogram(position="identity", alpha=0.25, bins =600)
ggplot(data, aes(x=cat_score, color=family)) +
geom_histogram(fill="white", position="dodge")+
theme(legend.position="top")+
geom_histogram(position="identity", alpha=0.25, bins =600)
ggplot(data, aes(x=cat_score, color=family)) +
geom_histogram(fill="white", position="dodge")
ggplot(data, aes(x=cat_score, color=family))
ggplot(data, aes(x=cat_score, color=sex)) +
geom_histogram(fill="white", alpha=0.5, position="identity")
ggplot(data, aes(x=cat_score, color=sex)) +
geom_histogram(fill="white", alpha=0.5, position="identity", bins =600)
ggplot(data, aes(x=cat_score, color=family)) +
geom_histogram(fill="white", position="dodge")+
theme(legend.position="top")+
geom_histogram(position="identity", alpha=0.25, bins =200)
ggplot(data, aes(x=cat_score, color=sex)) +
geom_histogram(fill="white", alpha=0.5, position="identity", bins =200)
p<-ggplot(df, aes(x=weight, color=sex)) +
geom_histogram(fill="white", position="dodge")+
geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
linetype="dashed")+
theme(legend.position="top")
ggplot(data, aes(x=cat_score, color=sex)) +
geom_histogram(fill="white", alpha=0.5, position="identity", bins =200)+
geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
linetype="dashed")+
p<-ggplot(df, aes(x=weight, color=sex)) +
geom_histogram(fill="white", position="dodge")+
geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
linetype="dashed")+
theme(legend.position="top")
ggplot(data, aes(x=cat_score, color=sex)) +
geom_histogram(fill="white", alpha=0.5, position="identity", bins =200)+
geom_vline(data=data, aes(xintercept=grp.mean, color=sex),
linetype="dashed")+
p<-ggplot(df, aes(x=weight, color=sex)) +
geom_histogram(fill="white", position="dodge")+
geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
linetype="dashed")+
theme(legend.position="top")
mu <- ddply(data, "sex", summarise, grp.mean=mean(cat_score))
ggplot(data, aes(x=cat_score, color=sex)) +
geom_histogram(fill="white", alpha=0.5, position="identity", bins =200)+
geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
linetype="dashed")+
p<-ggplot(df, aes(x=weight, color=sex)) +
geom_histogram(fill="white", position="dodge")+
geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
linetype="dashed")+
theme(legend.position="top")
ggplot(data, aes(x=cat_score, color=sex)) +
geom_histogram(fill="white", alpha=0.5, position="identity", bins =200)+
geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
linetype="dashed")+
theme(legend.position="top")
ggplot(data, aes(x=cat_score, color=sex)) +
geom_histogram(fill="white", alpha=0.5, position="identity", bins =100)+
geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
linetype="dashed")+
theme(legend.position="top")
mu <- ddply(data, "groups", summarise, grp.mean=mean(cat_score))
ggplot(data, aes(x=cat_score, color=sex)) +
geom_histogram(fill="white", alpha=0.5, position="identity", bins =100)+
geom_vline(data=mu, aes(xintercept=grp.mean, color=groups),
linetype="dashed")+
theme(legend.position="top")
ggplot(data, aes(x=cat_score, color=groups)) +
geom_histogram(fill="white", alpha=0.5, position="identity", bins =100)+
geom_vline(data=mu, aes(xintercept=grp.mean, color=groups),
linetype="dashed")+
theme(legend.position="top")
ggplot(data, aes(x=cat_score, color=groups)) +
geom_histogram(fill="white", alpha=0.5, position="identity", bins =100)+
geom_vline(data=mu, aes(xintercept=grp.mean, color=groups),
linetype="dashed")+
theme(legend.position="top")+
facet_grid(sex ~ .)
ggplot(data, aes(x=cat_score, color=sex)) +
geom_histogram(fill="white", alpha=0.5, position="identity", bins =100)+
geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
linetype="dashed")+
theme(legend.position="top")+
facet_grid(groups ~ .)
ggplot(data, aes(x=cat_score, color=sex)) +
geom_histogram(fill="white", alpha=0.5, position="identity", bins =100)+
geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
linetype="dashed")+
theme(legend.position="top")+
facet_grid(groups ~ .)
mu <- ddply(data, "sex", summarise, grp.mean=mean(cat_score))
ggplot(data, aes(x=cat_score, color=sex)) +
geom_histogram(fill="white", alpha=0.5, position="identity", bins =100)+
geom_vline(data=mu, aes(xintercept=grp.mean, color=sex),
linetype="dashed")+
theme(legend.position="top")+
facet_grid(groups ~ .)
mu <- ddply(data, "groups", summarise, grp.mean=mean(cat_score))
mu <- ddply(data, "groups", summarise, grp.mean=mean(cat_score))
ggplot(data, aes(x=cat_score, color=sex)) +
geom_histogram(fill="white", alpha=0.5, position="identity", bins =100)+
geom_vline(data=mu, aes(xintercept=grp.mean, color=groups),
linetype="dashed")+
theme(legend.position="top")+
facet_grid(groups ~ .)
ggplot(data, aes(x=cat_score, color=sex)) +
geom_histogram(fill="white", alpha=0.5, position="identity", bins =100)+
geom_vline(data=mu, aes(xintercept=grp.mean),
linetype="dashed")+
theme(legend.position="top")+
facet_grid(groups ~ .)
