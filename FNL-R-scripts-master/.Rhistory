Thyroid +
OSA,
data = data)
summary(coxfit)
ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 4)
library(readxl)
library(tidyverse)
library(DescTools)
library(lme4)
library(broom.mixed)
library(kableExtra)
library(xtable)
library(emmeans)
library(ggsci)
library(superdiag)
library(mcmcplots)
library(gridExtra)
library(plyr)
library(forcats)
library(gghighlight)
library(dplyr)
# library(survMisc)
# library(jskm)
# library(survey)
library(ggplot2)
library(readxl)
library(survival)
library(survminer)
library(flexsurv)
library(survtools)
library(finalfit)
library(gtsummary)
library(tidyverse)
library(ggfortify)
library(ggplot2)
library(ggspectra)
library(ggrepel)
library(readxl)
library(survival)
library(ranger)
library(dplyr)
library(ggfortify)
data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx")
# remove spaces from column and value names
names(data) <- str_replace_all(names(data), " ", "_")
data <- data %>%
mutate(CoatColor = str_replace_all(coat_color, " ", "_"))
# turn categorical vars into factor
data <- data %>%
mutate(Animal = Animal,
Age = as.numeric(Age),
Sex = as.factor(sex),
Weight = as.numeric(Weight),
CoatColor = as.factor(coat_color),
Family = as.character(family),
BCS = as.ordered(BCS),
Treatment = relevel(as.factor(groups), ref = "Unirradiated"))
Status = data$`Cat_2.0`
coxfit <- coxph(Surv(Age, Status) ~ Treatment + Sex + #Treatment*Sex +
Amyloidosis +
AML +
GCT +
Hard_ACA +
Hard_Ad +
#Hemangiosarcoma +
HCC +
Histiocytic_Sarcoma +
#Intracranial_Tumors +
#LSA +
`LSA_B/T` +
#LSA_PreT+
#`LSA_B-cell`+
#`LSA_Subtype`+
Mamm_ACA +
Pulmonary_Adenocarcinoma +
Pituitary_Adenoma +
#Metastatic_Tumors +
STS +
Thyroid +
OSA,
data = data)
summary(coxfit)
ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 4)
coxfit <- coxph(Surv(Age, Status) ~ Treatment + Sex + #Treatment*Sex +
Amyloidosis +
AML +
GCT +
Hard_ACA +
Hard_Ad +
#Hemangiosarcoma +
HCC +
Histiocytic_Sarcoma +
#Intracranial_Tumors +
LSA +
#`LSA_B/T` +
LSA_PreT+
`LSA_B-cell`+
#`LSA_Subtype`+
Mamm_ACA +
Pulmonary_Adenocarcinoma +
Pituitary_Adenoma +
#Metastatic_Tumors +
STS +
Thyroid +
OSA,
data = data)
summary(coxfit)
ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 4)
coxfit <- coxph(Surv(Age, Status) ~ Treatment + Sex + #Treatment*Sex +
Amyloidosis +
AML +
GCT +
Hard_ACA +
Hard_Ad +
#Hemangiosarcoma +
HCC +
Histiocytic_Sarcoma +
#Intracranial_Tumors +
#LSA +
#`LSA_B/T` +
LSA_PreT+
`LSA_B-cell`+
#`LSA_Subtype`+
Mamm_ACA +
Pulmonary_Adenocarcinoma +
Pituitary_Adenoma +
#Metastatic_Tumors +
STS +
Thyroid +
OSA,
data = data)
summary(coxfit)
ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 4)
coxfit <- coxph(Surv(Age, Status) ~ Treatment + Sex + #Treatment*Sex +
# Amyloidosis +
# AML +
# GCT +
# Hard_ACA +
# Hard_Ad +
# HCC +
# Histiocytic_Sarcoma +
# LSA_PreT+
# `LSA_B-cell`+
# Mamm_ACA +
# Pulmonary_Adenocarcinoma +
# Pituitary_Adenoma +
# STS +
# Thyroid +
OSA,
data = data)
summary(coxfit)
ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 4)
coxfit <- coxph(Surv(Age, Status) ~ Treatment + Sex + #Treatment*Sex +
Amyloidosis,# +
# AML +
# GCT +
# Hard_ACA +
# Hard_Ad +
# HCC +
# Histiocytic_Sarcoma +
# LSA_PreT+
# `LSA_B-cell`+
# Mamm_ACA +
# Pulmonary_Adenocarcinoma +
# Pituitary_Adenoma +
# STS +
# Thyroid +
#OSA,
data = data)
summary(coxfit)
ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 4)
coxfit <- coxph(Surv(Age, Status) ~ Treatment + Sex + #Treatment*Sex +
Amyloidosis +
# AML +
# GCT +
# Hard_ACA +
# Hard_Ad +
# HCC +
# Histiocytic_Sarcoma +
# LSA_PreT+
# `LSA_B-cell`+
# Mamm_ACA +
# Pulmonary_Adenocarcinoma +
# Pituitary_Adenoma +
# STS +
# Thyroid +
OSA,
data = data)
summary(coxfit)
ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 4)
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("SPIAT")
library(SPIAT)
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("SPIAT")
library(SPIAT)
BiocManager::install("SPIAT")
install.packages('glue')
install.packages("glue")
install.packages('cli')
install.packages("cli")
install.packages('dplyr')
install.packages("cli")
BiocManager::install("SPIAT")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("SPIAT")
library(SPIAT)
install.packages('cli')
install.packages('cli')
install.packages("cli")
install.packages("cli")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("SPIAT")
remove.packages("cli")
install.packages("cli")
library(cli)
install.packages("cli")
library(cli)
library(cli)
BiocManager::install("SPIAT")
library(SPIAT)
BiocManager::install("SPIAT")
install.packages("SPIAT")
library(SPIAT)
gc()
library(SPIAT)
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("SPIAT")
install.packages("SPIAT")
library(SPIAT)
if (!requireNamespace("devtools", quietly = TRUE)) {
install.packages("devtools")}
devtools::install_github("TrigosTeam/SPIAT")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("SPIAT")
BiocManager::install("SPIAT")
if (!requireNamespace("devtools", quietly = TRUE)) {
install.packages("devtools")}
devtools::install_github("TrigosTeam/SPIAT")
library(SPIAT)
library(readxl)
data <- read_excel("C:/Users/edmondsonef/Desktop/CPPN.xlsx")
library(survMisc)
library(survival)
library(jskm)
library(survey)
library(survminer)
library(survival)
library(ggplot2)
library(ggfortify)
library(readxl)
library(survival)
library(survminer)
library(flexsurv)
library(dplyr)
library(survtools)
library(finalfit)
library(gtsummary)
library(readxl)
library(tidyverse)
library(DescTools)
library(lme4)
library(broom.mixed)
library(kableExtra)
library(xtable)
library(emmeans)
library(ggsci)
library(superdiag)
library(mcmcplots)
library(gridExtra)
library(plyr)
library(forcats)
library(gghighlight)
library(dplyr)
library(ggplot2)
library(readxl)
library(survival)
library(survminer)
library(flexsurv)
library(survtools)
library(finalfit)
library(gtsummary)
library(tidyverse)
library(ggfortify)
library(ggplot2)
library(ggspectra)
library(ggrepel)
library(survival)
library(ranger)
library(dplyr)
library(ggfortify)
library(tidyverse)
library(tidytidbits)
library(survivalAnalysis)
Status = data$`SurvivalTime`
library(readxl)
data <- read_excel("C:/Users/edmondsonef/Desktop/CPPN.xlsx")
Status = data$`censor`
Day = data$`SurvivalTime`
coxfit <- coxph(Surv(Day, Status))
coxfit <- coxph(Surv(Day, Status),data = data)
summary(coxfit)
Status = data$`censor`
Day = data$`SurvivalTime`
coxfit <- coxph(Surv(Day, Status),data = data)
summary(coxfit)
fit <- survfit(Surv(Days, Censor), data=data)
fit <- survfit(Surv(Day, Status), data=data)
data$censor
data$SurvivalTime
fit <- survfit(Surv(Day, Status)~PrimaryDx, data=data)
fit
surv_median(fit)
ggsurvplot2(fit, data=data, xlab = "Days (post-dosing)", pval = T, risk.table = T)
fit <- survfit(Surv(Day, Status)~censor, data=data)
ggsurvplot2(fit, data=data, xlab = "Days (post-dosing)", pval = T, risk.table = T)
fit <- survfit(Surv(Day, Status)~Grade, data=data)
ggsurvplot2(fit, data=data, xlab = "Days (post-dosing)", pval = T, risk.table = T)
coxfit <- coxph(Surv(Day, Status)~Grade,data = data)
summary(coxfit)
ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
coxfit <- coxph(Surv(Day, Status)~PrimaryDx,data = data)
summary(coxfit)
ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
fit <- survfit(Surv(Day, Status)~PrimaryDx, data=data)
ggsurvplot2(fit, data=data, xlab = "Days (post-dosing)", pval = T, risk.table = T)
Surv(Day, Status)
fit <- Surv(Day, Status)
ggsurvplot2(fit, data=data, xlab = "Days (post-dosing)", pval = T, risk.table = T)
ggsurvplot2(fit, data=data, xlab = "Days (post-dosing)", pval = T, risk.table = T)
fit <- survfit(Surv(Day, Status)~PrimaryDx, data=data)
ggsurvplot2(fit, data=data, xlab = "Days (post-dosing)", pval = T, risk.table = T)
fit <- survfit(Surv(Day, Status), data=data)
library(readxl)
data <- read_excel("C:/Users/edmondsonef/Desktop/CPPN.xlsx",
col_names = FALSE)
View(data)
fit <- survfit(Surv(Day, Status)~all, data=data)
ggsurvplot2(fit, data=data, xlab = "Days (post-dosing)", pval = T, risk.table = T)
library(readxl)
data <- read_excel("C:/Users/edmondsonef/Desktop/CPPN.xlsx",
col_names = FALSE)
library(readxl)
data <- read_excel("C:/Users/edmondsonef/Desktop/CPPN.xlsx",
col_names = T)
Status = data$`censor`
Day = data$`SurvivalTime`
fit <- survfit(Surv(Day, Status)~all, data=data)
ggsurvplot2(fit, data=data, xlab = "Days (post-dosing)", pval = T, risk.table = T)
coxfit <- coxph(Surv(Day, Status)~PrimaryDx,data = data)
summary(coxfit)
ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
fit <- survfit(Surv(Day, Status)~PrimaryDx, data=data)
ggsurvplot2(fit, data=data, xlab = "Days (post-dosing)", pval = T, risk.table = T)
data <- data %>%  mutate(Family = as.character(family),
PrimaryDx = as.ordered(PrimaryDx))#,
data <- data %>%  mutate(Grade = as.ordered(Grade),
PrimaryDx = as.ordered(PrimaryDx))#,
Status = data$`censor`
Day = data$`SurvivalTime`
fit <- survfit(Surv(Day, Status)~all, data=data)
ggsurvplot2(fit, data=data, xlab = "Days (post-dosing)", pval = T, risk.table = T)
fit <- survfit(Surv(Day, Status)~PrimaryDx, data=data)
ggsurvplot2(fit, data=data, xlab = "Days (post-dosing)", pval = T, risk.table = T)
coxfit <- coxph(Surv(Day, Status)~PrimaryDx,data = data)
summary(coxfit)
ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
coxfit <- coxph(Surv(Day, Status)~Grade,data = data)
summary(coxfit)
ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
data <- data %>%  mutate(Grade = as.character(Grade),
PrimaryDx = as.character(PrimaryDx))#,
f
f
coxfit <- coxph(Surv(Day, Status)~Grade,data = data)
summary(coxfit)
ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
coxfit <- coxph(Surv(Day, Status)~PrimaryDx,data = data)
summary(coxfit)
ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
coxfit <- coxph(Surv(Day, Status)~PrimaryDx + Grade + `Most prominent pattern described`,data = data)
summary(coxfit)
ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
data$`Most prominent pattern described`
coxfit <- coxph(Surv(Day, Status)~PrimaryDx + `Most prominent pattern described`,data = data)
summary(coxfit)
ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
coxfit <- coxph(Surv(Day, Status)~Grade + `Most prominent pattern described`,data = data)
summary(coxfit)
ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
data <- data %>%  mutate(Grade = as.character(Grade),
PrimaryDx = as.character(PrimaryDx),
`Most prominent pattern described` = as.character(`Most prominent pattern described`))#,
coxfit <- coxph(Surv(Day, Status)~Grade + `Most prominent pattern described`,data = data)
summary(coxfit)
ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
coxfit <- coxph(Surv(Day, Status)~ `Most prominent pattern described`,data = data)
summary(coxfit)
ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
data$`Metastasis (histo) Lymph node (0=not reported/not assessed, 1=reported )`
coxfit <- coxph(Surv(Day, Status)~ `Metastasis (histo) Lymph node (0=not reported/not assessed, 1=reported )`,data = data)
summary(coxfit)
ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
fit <- survfit(Surv(Day, Status)~`Metastasis (histo) Lymph node (0=not reported/not assessed, 1=reported )`, data=data)
ggsurvplot2(fit, data=data, xlab = "Days (post-dosing)", pval = T, risk.table = T)
fit <- survfit(Surv(Day, Status)~`Metastasis (histo) Lymph node (0=not reported/not assessed, 1=reported )`, data=data)
data$`Metastasis (histo) Lymph node (0=not reported/not assessed, 1=reported )`
fit <- survfit(Surv(Day, Status)~ data$`Metastasis (histo) Lymph node (0=not reported/not assessed, 1=reported )`, data=data)
ggsurvplot2(fit, data=data, xlab = "Days (post-dosing)", pval = T, risk.table = T)
data <- data %>%  mutate(Grade = as.character(Grade),
PrimaryDx = as.character(PrimaryDx),
`Most prominent pattern described` = as.numeric(`Most prominent pattern described`))
Day = data$`SurvivalTime`
fit <- survfit(Surv(Day, Status)~all, data=data)
ggsurvplot2(fit, data=data, xlab = "Days (post-dosing)", pval = T, risk.table = T)
summary(fit)
fit
survfit
?survfit
my.formula <- y ~ x
ggplot(data = data, aes(y = data$`MitoticCount`, x = data$'SurvivalTime'), na.rm=TRUE) +
geom_smooth(method = "lm", se=FALSE, formula = my.formula) +
stat_poly_eq(formula = y ~ x, show.legend = T, parse = TRUE, na.rm=T) +
geom_point(na.rm=TRUE)+
#scale_x_continuous(name = "Days") +
#scale_y_continuous(name = "ss") +
theme_bw(base_size = 18)
###3D scatterplot
library(scatterplot3d)
my.formula <- y ~ x
ggplot(data = data, aes(y = data$`MitoticCount`, x = data$'SurvivalTime'), na.rm=TRUE) +
geom_smooth(method = "lm", se=FALSE, formula = my.formula) +
stat_poly_eq(formula = y ~ x, show.legend = T, parse = TRUE, na.rm=T) +
geom_point(na.rm=TRUE)+
#scale_x_continuous(name = "Days") +
#scale_y_continuous(name = "ss") +
theme_bw(base_size = 18)
ggplot(data = data, aes(y = data$`MitoticCount`, x = data$'SurvivalTime'), na.rm=TRUE) +
geom_smooth(method = "lm", se=FALSE, formula = my.formula)
ggplot(data = data, aes(y = data$`MitoticCount`, x = data$'SurvivalTime'), na.rm=TRUE) +
geom_smooth(method = "lm", se=FALSE, formula = my.formula) +
#tat_poly_eq(formula = y ~ x, show.legend = T, parse = TRUE, na.rm=T) +
geom_point(na.rm=TRUE)+
#scale_x_continuous(name = "Days") +
#scale_y_continuous(name = "ss") +
theme_bw(base_size = 18)
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("SPIAT")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("SPIAT")
install.packages("SPIAT")
if (!requireNamespace("devtools", quietly = TRUE)) {
install.packages("devtools")}
devtools::install_github("TrigosTeam/SPIAT")
install.packages("Rtools")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("SPIAT")
if (!require("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("SPIAT")
install.packages('Rtools')
library(readxl)
library(readxl)
