Treatment = relevel(as.factor(groups), ref = "Unirradiated"),
`Number of Tumors` = relevel(as.factor(`Number of Tumors`), ref = "No tumors"))
data <- data %>%  filter(`Did Not Dilate` == 0)
Status = data$`Cat 2.0`
Day = data$`Cat 2.0 day`
coxfit <- coxph(Surv(Day, Status) ~ Treatment + Sex, data = data)
summary(coxfit)
plot_cox <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
coxfit <- coxph(Surv(Day, Status) ~ `Number of Tumors`, data = data)
summary(coxfit)
plot_tumors <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_tumors
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_Harderian_DND")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_DND")
data <- read_excel("C:/Users/edmondsonef/Desktop/Supplementary Table 1.xlsx", sheet = "Animal Data")
data <- data %>%  mutate(Family = as.character(family),
BCS = as.ordered(BCS),
Sex = sex,
Treatment = relevel(as.factor(groups), ref = "Unirradiated"),
`Number of Tumors` = relevel(as.factor(`Number of Tumors`), ref = "No tumors"))
data <- data %>%  filter(`Did Not Dilate` == 0)
Status = data$`Cat 2.0`
coxfit <- coxph(Surv(Day, Status) ~ `Number of Tumors`, data = data)
summary(coxfit)
plot_tumors <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_tumors
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_Harderian_DND")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_DND")
data <- read_excel("C:/Users/edmondsonef/Desktop/Supplementary Table 1.xlsx", sheet = "Animal Data")
data <- data %>%  mutate(Family = as.character(family),
BCS = as.ordered(BCS),
Sex = sex,
Treatment = relevel(as.factor(groups), ref = "Unirradiated"),
`Number of Tumors` = relevel(as.factor(`Number of Tumors`), ref = "No tumors"))
data <- data %>%  filter(`Did Not Dilate` == 0)
Status = data$`Cat 2.0`
Day = data$`Cat 2.0 day`
coxfit <- coxph(Surv(Day, Status) ~ `Number of Tumors`, data = data)
summary(coxfit)
plot_tumors <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_tumors
data <- read_excel("C:/Users/edmondsonef/Desktop/Supplementary Table 1.xlsx", sheet = "Animal Data")
data <- data %>%  mutate(Family = as.character(family),
BCS = as.ordered(BCS),
Sex = sex,
Treatment = relevel(as.factor(groups), ref = "Unirradiated"),
`Number of Tumors` = relevel(as.factor(`Number of Tumors`), ref = "No tumors"))
data <- data %>%  filter(`Did Not Dilate` == 0)
#data <- data %>%  filter(Treatment != "Unirradiated")
#data <- data %>%  filter(Treatment == "HZE")
Status = data$`Cat 2.0`
Day = data$`Cat 2.0 day`
coxfit <- coxph(Surv(Day, Status) ~ `Number of Tumors`, data = data)
summary(coxfit)
plot_tumors <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_tumors
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_Harderian_DND")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_DND")
data <- read_excel("C:/Users/edmondsonef/Desktop/Supplementary Table 1.xlsx", sheet = "Animal Data")
data <- data %>%  mutate(Family = as.character(family),
BCS = as.ordered(BCS),
Sex = sex,
Treatment = relevel(as.factor(groups), ref = "Unirradiated"),
`Number of Tumors` = relevel(as.factor(`Number of Tumors`), ref = "No tumors"))
data <- data %>%  filter(`Did Not Dilate` == 0)
Status = data$`Cat 2.0`
Day = data$`Cat 2.0 day`
library(readxl)
library(tidyverse)
library(DescTools)
library(lme4)
library(broom.mixed)
library(kableExtra)
library(xtable)
library(emmeans)
library(ggsci)
library(superdiag)
library(mcmcplots)
library(gridExtra)
library(plyr)
library(forcats)
library(gghighlight)
library(dplyr)
library(ggplot2)
library(readxl)
library(survival)
library(survminer)
library(flexsurv)
library(survtools)
library(finalfit)
library(gtsummary)
library(tidyverse)
library(ggfortify)
library(ggplot2)
library(ggspectra)
library(ggrepel)
library(survival)
library(ranger)
library(dplyr)
library(ggfortify)
library(tidyverse)
library(tidytidbits)
library(survivalAnalysis)
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_Harderian_DND")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/2023 Cataract Data.xlsx", sheet = "DND")
data <- read_excel("C:/Users/edmondsonef/Desktop/Supplementary Table 1.xlsx", sheet = "Animal Data")
data <- data %>%  mutate(Family = as.character(family),
BCS = as.ordered(BCS),
Sex = sex,
Treatment = relevel(as.factor(groups), ref = "Unirradiated"),
`Number of Tumors` = relevel(as.factor(`Number of Tumors`), ref = "No tumors"))
data <- data %>%  filter(`Did Not Dilate` == 0)
#####Plots by Family
#####
cats$families <-  as.character(cats$Family)
Status = data$`Cat 2.0`
Day = data$`Cat 2.0 day`
coxfit <- coxph(Surv(Day, Status) ~ Treatment + Sex, data = data)
summary(coxfit)
plot_cox <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
coxfit <- coxph(Surv(Day, Status) ~ `Number of Tumors`, data = data)
summary(coxfit)
plot_tumors <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_tumors
coxfit <- coxph(Surv(Day, Status) ~ `Old Number of Tumors`, data = data)
summary(coxfit)
plot_tumors <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_tumors
coxfit <- coxph(Surv(Day, Status) ~ `Number of Tumors`, data = data)
summary(coxfit)
plot_tumors <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_tumors
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_Harderian_DND")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_DND")
data <- read_excel("C:/Users/edmondsonef/Desktop/Supplementary Table 1.xlsx", sheet = "Animal Data")
data <- data %>%  mutate(Family = as.character(family),
BCS = as.ordered(BCS),
Sex = sex,
Treatment = relevel(as.factor(groups), ref = "Unirradiated"),
`Number of Tumors` = relevel(as.factor(`Number of Tumors`), ref = "No tumors"))
data <- data %>%  filter(`Did Not Dilate` == 0)
coxfit <- coxph(Surv(Day, Status) ~ `Number of Tumors`, data = data)
summary(coxfit)
plot_tumors <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_tumors
covariate_names <- c(Treatment = relevel(as.factor(data$groups), ref = "Unirradiated"),
sex=data$sex,
`sex:female`="F",
Family = as.numeric(data$family),
CoatColor=data$"coat color",
BCS = as.ordered(data$BCS),
#Amyloidosis=data$Amyloidosis,
AML=data$`Acute Myeloid Leukemia`,
GCT=data$`Granulosa Cell Tumor`,
Hard_ACA=data$`Harderian Adenocarcinoma`,
Hard_Ad=data$`Harderian Adenoma`,
HCC=data$`Hepatocellular Carcinoma`,
Hist_Sarc=data$`Histiocytic Sarcoma`,
LSA_PreT=data$`LSA_T-cell`,
`LSA_B-cell`=data$`LSA_B-cell`,
#`LSA_B-cell`=data$`LSA_other`,
Mamm_ACA=data$`Mammary Adenocarcinoma`,
OSA=data$`Osteosarcoma`,
Pulmonary_ACA = data$`Pulmonary Adenocarcinoma`,
Pituitary_Ad=data$`Pituitary Adenoma`,
STS=data$`Soft Tissue Sarcoma`,
Thyroid =data$`Thyroid Tumor`,
Pigment_Dispersion = data$Pigment_Dispersion,
Did_not_dilate = data$`Did Not Dilate`)
covariate_names <- c(Treatment = relevel(as.factor(data$groups), ref = "Unirradiated"),
sex=data$sex,
`sex:female`="F",
Family = as.numeric(data$family),
CoatColor=data$"coat color",
BCS = as.ordered(data$BCS),
#Amyloidosis=data$Amyloidosis,
AML=data$`Acute Myeloid Leukemia`,
GCT=data$`Granulosa Cell Tumor`,
Hard_ACA=data$`Harderian Adenocarcinoma`,
Hard_Ad=data$`Harderian Adenoma`,
HCC=data$`Hepatocellular Carcinoma`,
Hist_Sarc=data$`Histiocytic Sarcoma`,
LSA_PreT=data$`LSA_T-cell`,
`LSA_B-cell`=data$`LSA_B-cell`,
#`LSA_B-cell`=data$`LSA_other`,
Mamm_ACA=data$`Mammary Adenocarcinoma`,
OSA=data$`Osteosarcoma`,
Pulmonary_ACA = data$`Pulmonary Adenocarcinoma`,
Pituitary_Ad=data$`Pituitary Adenoma`,
STS=data$`Soft Tissue Sarcoma`,
Thyroid =data$`Thyroid Adenoma`,
Pigment_Dispersion = data$Pigment_Dispersion,
Did_not_dilate = data$`Did Not Dilate`)
df <- data %>% mutate(sex=rename_factor(sex, `M` = "male", `F` = "female"))
map(vars(Treatment, sex, #Family,
#`coat color`,
Pigment_Dispersion, `Did Not Dilate`,
`Acute Myeloid Leukemia`, `Granulosa Cell Tumor`,
`Harderian Adenocarcinoma`, `Harderian Adenoma`, `Hepatocellular Carcinoma`, `Histiocytic Sarcoma`, `LSA_T-cell`,
`LSA_B-cell`,`Mammary Adenocarcinoma`,`Osteosarcoma`,`Pulmonary Adenocarcinoma`,
`Pituitary Adenoma`,`Soft Tissue Sarcoma`,`Thyroid Tumor`,
`Number of Tumors`), function(by)
{
analyse_multivariate(df,
vars(Day, Status),
covariates = list(by), # covariates expects a list
covariate_name_dict = covariate_names)
}) %>%
forest_plot(factor_labeller = covariate_names,
endpoint_labeller = c(time="OS"),
orderer = ~order(HR),
labels_displayed = c("endpoint", "factor", "n"),
ggtheme = ggplot2::theme_bw(base_size = 12))
map(vars(Treatment, sex, #Family,
#`coat color`,
Pigment_Dispersion, `Did Not Dilate`,
`Acute Myeloid Leukemia`, `Granulosa Cell Tumor`,
`Harderian Adenocarcinoma`, `Harderian Adenoma`, `Hepatocellular Carcinoma`, `Histiocytic Sarcoma`, `LSA_T-cell`,
`LSA_B-cell`,`Mammary Adenocarcinoma`,`Osteosarcoma`,`Pulmonary Adenocarcinoma`,
`Pituitary Adenoma`,`Soft Tissue Sarcoma`,`Thyroid Adenoma`,
`Number of Tumors`), function(by)
{
analyse_multivariate(df,
vars(Day, Status),
covariates = list(by), # covariates expects a list
covariate_name_dict = covariate_names)
}) %>%
forest_plot(factor_labeller = covariate_names,
endpoint_labeller = c(time="OS"),
orderer = ~order(HR),
labels_displayed = c("endpoint", "factor", "n"),
ggtheme = ggplot2::theme_bw(base_size = 12))
map(vars(Family), function(by)
{
analyse_multivariate(df,
vars(Day, Status),
covariates = list(by), # covariates expects a list
covariate_name_dict = covariate_names)
}) %>%
forest_plot(factor_labeller = covariate_names,
endpoint_labeller = c(time="OS"),
orderer = ~order(HR),
labels_displayed = c("endpoint", "factor", "n"),
ggtheme = ggplot2::theme_bw(base_size = 12))
data <- data %>%  filter(`Harderian Adenoma` == 0)
Status = data$`Cat 2.0`
Day = data$`Cat 2.0 day`
coxfit <- coxph(Surv(Day, Status) ~ Treatment + Sex, data = data)
summary(coxfit)
plot_cox <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_cox
coxfit <- coxph(Surv(Day, Status) ~ `Number of Tumors`, data = data)
summary(coxfit)
plot_tumors <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_tumors
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_Harderian_DND")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_DND")
data <- read_excel("C:/Users/edmondsonef/Desktop/Supplementary Table 1.xlsx", sheet = "Animal Data")
data <- data %>%  mutate(Family = as.character(family),
BCS = as.ordered(BCS),
Sex = sex,
Treatment = relevel(as.factor(groups), ref = "Unirradiated"),
`Number of Tumors` = relevel(as.factor(`Number of Tumors`), ref = "No tumors"))
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_Harderian_DND")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_DND")
data <- read_excel("C:/Users/edmondsonef/Desktop/Supplementary Table 1.xlsx", sheet = "Animal Data")
data <- data %>%  mutate(Family = as.character(family),
BCS = as.ordered(BCS),
Sex = sex,
Treatment = relevel(as.factor(groups), ref = "Unirradiated"),
`Number of Tumors` = relevel(as.factor(`Number of Tumors`), ref = "No tumors"))
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_Harderian_DND")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_DND")
data <- read_excel("C:/Users/edmondsonef/Desktop/Supplementary Table 1.xlsx", sheet = "Animal Data")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_Harderian_DND")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_DND")
data <- read_excel("C:/Users/edmondsonef/Desktop/Supplementary Table 1.xlsx", sheet = "Animal Data")
data <- data %>%  mutate(Family = as.character(family),
BCS = as.ordered(BCS),
Sex = sex,
Treatment = relevel(as.factor(groups), ref = "Unirradiated"),
`Number of Tumors` = relevel(as.factor(`Number of Tumors`), ref = "No tumors"))
data <- data %>%  filter(`Did Not Dilate` == 0)
data <- data %>%  filter(`Harderian Adenoma` == 0)
Status = data$`Cat 2.0`
Day = data$`Cat 2.0 day`
coxfit <- coxph(Surv(Day, Status) ~ Treatment + Sex, data = data)
summary(coxfit)
plot_cox <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_cox
coxfit <- coxph(Surv(Day, Status) ~ `Number of Tumors`, data = data)
summary(coxfit)
plot_tumors <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_tumors
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_Harderian_DND")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_DND")
data <- read_excel("C:/Users/edmondsonef/Desktop/Supplementary Table 1.xlsx", sheet = "Animal Data")
data <- data %>%  mutate(Family = as.character(family),
BCS = as.ordered(BCS),
Sex = sex,
Treatment = relevel(as.factor(groups), ref = "Unirradiated"),
`Number of Tumors` = relevel(as.factor(`Number of Tumors`), ref = "No tumors"))
Status = data$`Cat 2.0`
Day = data$`Cat 2.0 day`
coxfit <- coxph(Surv(Day, Status) ~ Treatment + Sex, data = data)
summary(coxfit)
plot_cox <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_cox
coxfit <- coxph(Surv(Day, Status) ~ `Number of Tumors`, data = data)
summary(coxfit)
plot_tumors <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_tumors
coxfit <- coxph(Surv(Day, Status) ~ Treatment + Harderian:`Number of Tumors`, data = data)
summary(coxfit)
ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
data <- data %>%  filter(`Harderian Adenoma` == 0)
Status = data$`Cat 2.0`
Day = data$`Cat 2.0 day`
coxfit <- coxph(Surv(Day, Status) ~ Treatment + Sex, data = data)
summary(coxfit)
plot_cox <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_cox
coxfit <- coxph(Surv(Day, Status) ~ `Number of Tumors`, data = data)
summary(coxfit)
plot_tumors <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_tumors
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_Harderian_DND")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_DND")
data <- read_excel("C:/Users/edmondsonef/Desktop/Supplementary Table 1.xlsx", sheet = "Animal Data")
data <- data %>%  mutate(Family = as.character(family),
BCS = as.ordered(BCS),
Sex = sex,
Treatment = relevel(as.factor(groups), ref = "Unirradiated"),
`Number of Tumors` = relevel(as.factor(`Number of Tumors`), ref = "No tumors"))
data <- data %>%  filter(`Did Not Dilate` == 0)
coxfit <- coxph(Surv(Day, Status) ~ Treatment + Harderian:`Number of Tumors`, data = data)
summary(coxfit)
coxfit <- coxph(Surv(Day, Status) ~ Treatment + Harderian + `Number of Tumors`, data = data)
summary(coxfit)
ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_tumors <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_tumors
coxfit <- coxph(Surv(Day, Status) ~ Treatment + Harderian + `Number of Tumors`, data = data)
summary(coxfit)
coxfit <- coxph(Surv(Day, Status) ~ Treatment + `Harderian Adenoma` + `Number of Tumors`, data = data)
summary(coxfit)
plot_tumors <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_tumors
coxfit <- coxph(Surv(Day, Status) ~ Treatment + `Harderian Adenoma` + `Number of Tumors`, data = data)
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_Harderian_DND")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_DND")
data <- read_excel("C:/Users/edmondsonef/Desktop/Supplementary Table 1.xlsx", sheet = "Animal Data")
data <- data %>%  mutate(Family = as.character(family),
BCS = as.ordered(BCS),
Sex = sex,
Treatment = relevel(as.factor(groups), ref = "Unirradiated"),
`Number of Tumors` = relevel(as.factor(`Number of Tumors`), ref = "No tumors"))
data <- data %>%  filter(`Did Not Dilate` == 0)
Status = data$`Cat 2.0`
Day = data$`Cat 2.0 day`
coxfit <- coxph(Surv(Day, Status) ~ Treatment + `Harderian Adenoma` + `Number of Tumors`, data = data)
summary(coxfit)
plot_tumors <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_tumors
coxfit <- coxph(Surv(Day, Status) ~ `Harderian Adenoma` + `Number of Tumors`, data = data)
summary(coxfit)
plot_tumors <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_tumors
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_Harderian_DND")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_DND")
data <- read_excel("C:/Users/edmondsonef/Desktop/Supplementary Table 1.xlsx", sheet = "Animal Data")
data <- data %>%  mutate(Family = as.character(family),
BCS = as.ordered(BCS),
Sex = sex,
Treatment = relevel(as.factor(groups), ref = "Unirradiated"),
`Number of Tumors` = relevel(as.factor(`Number of Tumors`), ref = "No tumors"))
data <- data %>%  filter(`Did Not Dilate` == 0)
Status = data$`Cat 2.0`
Day = data$`Cat 2.0 day`
coxfit <- coxph(Surv(Day, Status) ~ Treatment + Sex, data = data)
summary(coxfit)
plot_cox <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_cox
coxfit <- coxph(Surv(Day, Status) ~ `Number of Tumors`, data = data)
summary(coxfit)
plot_tumors <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_tumors
coxfit <- coxph(Surv(Day, Status) ~ `Harderian Adenoma` + `Number of Tumors`, data = data)
summary(coxfit)
plot_tumors <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_tumors
coxfit <- coxph(Surv(Day, Status) ~ Harderian + AML, data = data)
summary(coxfit)
plot_cox <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_cox
coxfit <- coxph(Surv(Day, Status) ~ `Harderian Adenoma` + AML, data = data)
summary(coxfit)
plot_cox <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_cox
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_Harderian_DND")
#data <- read_excel(path = "C:/Users/edmondsonef/Desktop/Cataract/CAT_final.xlsx", sheet = "RM_DND")
data <- read_excel("C:/Users/edmondsonef/Desktop/Supplementary Table 1.xlsx", sheet = "Animal Data")
data <- data %>%  mutate(Family = as.character(family),
BCS = as.ordered(BCS),
Sex = sex,
Treatment = relevel(as.factor(groups), ref = "Unirradiated"),
`Number of Tumors` = relevel(as.factor(`Number of Tumors`), ref = "No tumors"))
data <- data %>%  filter(`Did Not Dilate` == 0)
Status = data$`Cat 2.0`
Day = data$`Cat 2.0 day`
coxfit <- coxph(Surv(Day, Status) ~ Treatment + Sex, data = data)
summary(coxfit)
plot_cox <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_cox
coxfit <- coxph(Surv(Day, Status) ~ `Number of Tumors`, data = data)
summary(coxfit)
plot_tumors <- ggforest(coxfit, data = data, main = "Hazard Ratio: Merriam-Focht Score 2.0",
cpositions = c(0.02, 0.15, 0.3), fontsize = 1,
refLabel = "reference", noDigits = 3)
plot_tumors
library(readxl)
library(dplyr)
KPC <- read_excel("C:/Users/edmondsonef/Desktop/KPC DSP GENE LIST.xlsx", sheet = "Significant")
CosMX <- read_excel("C:/Users/edmondsonef/Desktop/KPC DSP GENE LIST.xlsx", sheet = "CosMX mouse neuro")
CosMX <- read_excel("C:/Users/edmondsonef/Desktop/KPC DSP GENE LIST.xlsx", sheet = "CosMX mouse neuro")
axon <- read_excel("C:/Users/edmondsonef/Desktop/GO_term_summary_20230601_102507.xlsx")
CosMX <- read_excel("C:/Users/edmondsonef/Desktop/KPC DSP GENE LIST.xlsx", sheet = "CosMX mouse neuro")
new <- dplyr::left_join(KPC, CosMX, by = "SYMBOL")
write.csv(new, "C:/Users/edmondsonef/Desktop/data.csv")
#axon <- read_excel("C:/Users/edmondsonef/Desktop/GO_term_summary_20230601_102507.xlsx")
FDA <- read_excel("C:/Users/edmondsonef/Desktop/FDA Drug Targets.xlsx")
#axon <- read_excel("C:/Users/edmondsonef/Desktop/GO_term_summary_20230601_102507.xlsx")
FDA <- read_excel("C:/Users/edmondsonef/Desktop/FDA Drug Targets.xlsx")
KPC <- read_excel("C:/Users/edmondsonef/Desktop/KPC DSP GENE LIST.xlsx", sheet = "Significant")
KPC$SYMBOL_L <- tolower(KPC$SYMBOL)
FDA$SYMBOL_L <- tolower(FDA$SYMBOL)
new <- dplyr::left_join(KPC, FDA, by = "SYMBOL_L")
write.csv(new, "C:/Users/edmondsonef/Desktop/data.csv")
